!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("sxsl",[],e):"object"==typeof exports?exports.sxsl=e():t.sxsl=e()}(this,function(){return function(t){var e={};function r(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(s,i,function(e){return t[e]}.bind(null,i));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=6)}([function(t,e,r){"use strict";var s=r(1),i=e.ValidationError=function(t,e,r,s,i,n){s&&(this.property=s),t&&(this.message=t),r&&(r.id?this.schema=r.id:this.schema=r),e&&(this.instance=e),this.name=i,this.argument=n,this.stack=this.toString()};i.prototype.toString=function(){return this.property+" "+this.message};var n=e.ValidatorResult=function(t,e,r,s){this.instance=t,this.schema=e,this.propertyPath=s.propertyPath,this.errors=[],this.throwError=r&&r.throwError,this.disableFormat=r&&!0===r.disableFormat};function a(t,e){return e+": "+t.toString()+"\n"}n.prototype.addError=function(t){var e;if("string"==typeof t)e=new i(t,this.instance,this.schema,this.propertyPath);else{if(!t)throw new Error("Missing error detail");if(!t.message)throw new Error("Missing error message");if(!t.name)throw new Error("Missing validator type");e=new i(t.message,this.instance,this.schema,this.propertyPath,t.name,t.argument)}if(this.throwError)throw e;return this.errors.push(e),e},n.prototype.importErrors=function(t){"string"==typeof t||t&&t.validatorType?this.addError(t):t&&t.errors&&Array.prototype.push.apply(this.errors,t.errors)},n.prototype.toString=function(t){return this.errors.map(a).join("")},Object.defineProperty(n.prototype,"valid",{get:function(){return!this.errors.length}});var o=e.SchemaError=function t(e,r){this.message=e,this.schema=r,Error.call(this,e),Error.captureStackTrace(this,t)};o.prototype=Object.create(Error.prototype,{constructor:{value:o,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var c=e.SchemaContext=function(t,e,r,s,i){this.schema=t,this.options=e,this.propertyPath=r,this.base=s,this.schemas=i};c.prototype.resolve=function(t){return s.resolve(this.base,t)},c.prototype.makeChild=function(t,e){var r=void 0===e?this.propertyPath:this.propertyPath+p(e),i=s.resolve(this.base,t.id||""),n=new c(t,this.options,r,i,Object.create(this.schemas));return t.id&&!n.schemas[i]&&(n.schemas[i]=t),n};var h=e.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+-.]*:[^\s]*$/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"utc-millisec":function(t){return"string"==typeof t&&parseFloat(t)===parseInt(t,10)&&!isNaN(t)},regex:function(t){var e=!0;try{new RegExp(t)}catch(t){e=!1}return e},style:/\s*(.+?):\s*([^;]+);?/,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/};h.regexp=h.regex,h.pattern=h.regex,h.ipv4=h["ip-address"],e.isFormat=function(t,e,r){if("string"==typeof t&&void 0!==h[e]){if(h[e]instanceof RegExp)return h[e].test(t);if("function"==typeof h[e])return h[e](t)}else if(r&&r.customFormats&&"function"==typeof r.customFormats[e])return r.customFormats[e](t);return!0};var p=e.makeSuffix=function(t){return(t=t.toString()).match(/[.\s\[\]]/)||t.match(/^[\d]/)?t.match(/^\d+$/)?"["+t+"]":"["+JSON.stringify(t)+"]":"."+t};function l(t,e,r,s){"object"==typeof r?e[s]=f(t[s],r):-1===t.indexOf(r)&&e.push(r)}function u(t,e,r){e[r]=t[r]}function m(t,e,r,s){"object"==typeof e[s]&&e[s]&&t[s]?r[s]=f(t[s],e[s]):r[s]=e[s]}function f(t,e){var r=Array.isArray(e),s=r&&[]||{};return r?(t=t||[],s=s.concat(t),e.forEach(l.bind(null,t,s))):(t&&"object"==typeof t&&Object.keys(t).forEach(u.bind(null,t,s)),Object.keys(e).forEach(m.bind(null,t,e,s))),s}function d(t){return"/"+encodeURIComponent(t).replace(/~/g,"%7E")}e.deepCompareStrict=function t(e,r){if(typeof e!=typeof r)return!1;if(Array.isArray(e))return!!Array.isArray(r)&&e.length===r.length&&e.every(function(s,i){return t(e[i],r[i])});if("object"==typeof e){if(!e||!r)return e===r;var s=Object.keys(e),i=Object.keys(r);return s.length===i.length&&s.every(function(s){return t(e[s],r[s])})}return e===r},t.exports.deepMerge=f,e.objectGetPath=function(t,e){for(var r,s=e.split("/").slice(1),i;"string"==typeof(r=s.shift());){i=decodeURIComponent(r.replace(/~0/,"~").replace(/~1/g,"/"));if(!(i in t))return;t=t[i]}return t},e.encodePath=function(t){return t.map(d).join("")},e.getDecimalPlaces=function(t){var e=0;if(isNaN(t))return e;"number"!=typeof t&&(t=+t);var r=t.toString().split("e");if(2===r.length){if("-"!==r[1][0])return e;e=+r[1].slice(1)}var s=r[0].split(".");return 2===s.length&&(e+=s[1].length),e}},function(t,e,r){"use strict";var s=r(13),i=r(15);function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=v,e.resolve=function(t,e){return v(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e},e.format=function(t){i.isString(t)&&(t=v(t));return t instanceof n?t.format():n.prototype.format.call(t)},e.Url=n;var a=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["{","}","|","\\","^","`"].concat(["<",">","\"","`"," ","\r","\n","\t"]),p=["'"].concat(h),l=["%","/","?",";","#"].concat(p),u=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=r(16);function v(t,e,r){if(t&&i.isObject(t)&&t instanceof n)return t;var s=new n;return s.parse(t,e,r),s}n.prototype.parse=function(t,e,r){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),o=-1!==n&&n<t.indexOf("#")?"?":"#",h=t.split(o);h[0]=h[0].replace(/\\/g,"/");var v=t=h.join(o);if(v=v.trim(),!r&&1===t.split("#").length){var x=c.exec(v);if(x)return this.path=v,this.href=v,this.pathname=x[1],x[2]?(this.search=x[2],this.query=e?b.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var w=a.exec(v);if(w){var j=(w=w[0]).toLowerCase();this.protocol=j,v=v.substr(w.length)}if(r||w||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var O="//"===v.substr(0,2);!O||w&&g[w]||(v=v.substr(2),this.slashes=!0)}if(!g[w]&&(O||w&&!y[w])){for(var S,E,A=-1,L=0;L<u.length;L++){-1!==(P=v.indexOf(u[L]))&&(-1===A||P<A)&&(A=P)}-1!==(E=-1===A?v.lastIndexOf("@"):v.lastIndexOf("@",A))&&(S=v.slice(0,E),v=v.slice(E+1),this.auth=decodeURIComponent(S)),A=-1;for(L=0;L<l.length;L++){var P;-1!==(P=v.indexOf(l[L]))&&(-1===A||P<A)&&(A=P)}-1===A&&(A=v.length),this.host=v.slice(0,A),v=v.slice(A),this.parseHost(),this.hostname=this.hostname||"";var k="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!k)for(var I=this.hostname.split(/\./),R=(L=0,I.length),_;L<R;L++){_=I[L];if(_&&!_.match(m)){for(var T="",C=0,U=_.length;C<U;C++)127<_.charCodeAt(C)?T+="x":T+=_[C];if(!T.match(m)){var $=I.slice(0,L),N=I.slice(L+1),M=_.match(f);M&&($.push(M[1]),N.unshift(M[2])),N.length&&(v="/"+N.join(".")+v),this.hostname=$.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),k||(this.hostname=s.toASCII(this.hostname));var D=this.port?":"+this.port:"",q=this.hostname||"";this.host=q+D,this.href+=this.host,k&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!d[j])for(L=0,R=p.length;L<R;L++){var F=p[L];if(-1!==v.indexOf(F)){var z=encodeURIComponent(F);z===F&&(z=escape(F)),v=v.split(F).join(z)}}var V=v.indexOf("#");-1!==V&&(this.hash=v.substr(V),v=v.slice(0,V));var H=v.indexOf("?");if(-1!==H?(this.search=v.substr(H),this.query=v.substr(H+1),e&&(this.query=b.parse(this.query)),v=v.slice(0,H)):e&&(this.search="",this.query={}),v&&(this.pathname=v),y[j]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){D=this.pathname||"";var Z=this.search||"";this.path=D+Z}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",s=this.hash||"",n=!1,a="";this.host?n=t+this.host:this.hostname&&(n=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(a=b.stringify(this.query));var o=this.search||a&&"?"+a||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||y[e])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),s&&"#"!==s.charAt(0)&&(s="#"+s),o&&"?"!==o.charAt(0)&&(o="?"+o),e+n+(r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(o=o.replace("#","%23"))+s},n.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(i.isString(t)){var e=new n;e.parse(t,!1,!0),t=e}for(var r=new n,s=Object.keys(this),a=0,o;a<s.length;a++){o=s[a];r[o]=this[o]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var c=Object.keys(t),h=0,p;h<c.length;h++){p=c[h];"protocol"!==p&&(r[p]=t[p])}return y[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!y[t.protocol]){for(var l=Object.keys(t),u=0,m;u<l.length;u++){m=l[u];r[m]=t[m]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||g[t.protocol])r.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),2>f.length&&f.unshift(""),r.pathname=f.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var d=r.pathname||"",b=r.search||"";r.path=d+b}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var v=r.pathname&&"/"===r.pathname.charAt(0),x=t.host||t.pathname&&"/"===t.pathname.charAt(0),w=x||v||r.host&&t.pathname,j=w,O=r.pathname&&r.pathname.split("/")||[],S=(f=t.pathname&&t.pathname.split("/")||[],r.protocol&&!y[r.protocol]);if(S&&(r.hostname="",r.port=null,r.host&&(""===O[0]?O[0]=r.host:O.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),w=w&&(""===f[0]||""===O[0])),x)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,O=f;else if(f.length)O||(O=[]),O.pop(),O=O.concat(f),r.search=t.search,r.query=t.query;else if(!i.isNullOrUndefined(t.search)){if(S)r.hostname=r.host=O.shift(),(k=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"))&&(r.auth=k.shift(),r.host=r.hostname=k.shift());return r.search=t.search,r.query=t.query,i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!O.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var E=O.slice(-1)[0],A=(r.host||t.host||1<O.length)&&("."===E||".."===E)||""===E,L=0,P=O.length;0<=P;P--)"."===(E=O[P])?O.splice(P,1):".."===E?(O.splice(P,1),L++):L&&(O.splice(P,1),L--);if(!w&&!j)for(;L--;L)O.unshift("..");!w||""===O[0]||O[0]&&"/"===O[0].charAt(0)||O.unshift(""),A&&"/"!==O.join("/").substr(-1)&&O.push("");var k,I=""===O[0]||O[0]&&"/"===O[0].charAt(0);S&&(r.hostname=r.host=I?"":O.length?O.shift():"",(k=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"))&&(r.auth=k.shift(),r.host=r.hostname=k.shift()));return(w=w||r.host&&O.length)&&!I&&O.unshift(""),O.length?r.pathname=O.join("/"):(r.pathname=null,r.path=null),i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var t=this.host,e=o.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,r){var s=r(1),i=r(0);function n(t,e){this.id=t,this.ref=e}t.exports.SchemaScanResult=n,t.exports.scan=function(t,e){function r(t,e){if(e&&"object"==typeof e)if(e.$ref){var n=s.resolve(t,e.$ref);h[n]=h[n]?h[n]+1:0}else{var p=e.id?s.resolve(t,e.id):t;if(p){if(0>p.indexOf("#")&&(p+="#"),c[p]){if(!i.deepCompareStrict(c[p],e))throw new Error("Schema <"+e+"> already exists with different definition");return c[p]}c[p]=e,"#"==p[p.length-1]&&(c[p.substring(0,p.length-1)]=e)}a(p+"/items",Array.isArray(e.items)?e.items:[e.items]),a(p+"/extends",Array.isArray(e.extends)?e.extends:[e.extends]),r(p+"/additionalItems",e.additionalItems),o(p+"/properties",e.properties),r(p+"/additionalProperties",e.additionalProperties),o(p+"/definitions",e.definitions),o(p+"/patternProperties",e.patternProperties),o(p+"/dependencies",e.dependencies),a(p+"/disallow",e.disallow),a(p+"/allOf",e.allOf),a(p+"/anyOf",e.anyOf),a(p+"/oneOf",e.oneOf),r(p+"/not",e.not)}}function a(t,e){if(Array.isArray(e))for(var s=0;s<e.length;s++)r(t+"/"+s,e[s])}function o(t,e){if(e&&"object"==typeof e)for(var s in e)r(t+"/"+s,e[s])}var c={},h={};return r(t,e),new n(c,h)}},function(t,e,r){"use strict";r.r(e),r.d(e,"v1",function(){return m}),r.d(e,"v3",function(){return w}),r.d(e,"v4",function(){return j}),r.d(e,"v5",function(){return E});var s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),i=new Uint8Array(16);function n(){if(!s)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(i)}for(var a=[],o=0;256>o;++o)a[o]=(o+256).toString(16).substr(1);var c,h,p=function(t,e){var r=e||0,s=a;return[s[t[r++]],s[t[r++]],s[t[r++]],s[t[r++]],"-",s[t[r++]],s[t[r++]],"-",s[t[r++]],s[t[r++]],"-",s[t[r++]],s[t[r++]],"-",s[t[r++]],s[t[r++]],s[t[r++]],s[t[r++]],s[t[r++]],s[t[r++]]].join("")},l=0,u=0,m=function(t,e,r){var s=e&&r||0,i=e||[],a=(t=t||{}).node||c,o=void 0!==t.clockseq?t.clockseq:h;if(null==a||null==o){var m=t.random||(t.rng||n)();null==a&&(a=c=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==o&&(o=h=16383&(m[6]<<8|m[7]))}var f=void 0!==t.msecs?t.msecs:new Date().getTime(),d=void 0!==t.nsecs?t.nsecs:u+1,g=f-l+(d-u)/1e4;if(0>g&&void 0===t.clockseq&&(o=16383&o+1),(0>g||f>l)&&void 0===t.nsecs&&(d=0),1e4<=d)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=f,u=d,h=o;var y=(1e4*(268435455&(f+=122192928e5))+d)%4294967296;i[s++]=255&y>>>24,i[s++]=255&y>>>16,i[s++]=255&y>>>8,i[s++]=255&y;var b=268435455&1e4*(f/4294967296);i[s++]=255&b>>>8,i[s++]=255&b,i[s++]=16|15&b>>>24,i[s++]=255&b>>>16,i[s++]=128|o>>>8,i[s++]=255&o;for(var v=0;6>v;++v)i[s+v]=a[v];return e||p(i)},f=function(t,e,r){var s=function(t,s,i,n){var a=i&&n||0;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}(t)),"string"==typeof s&&(s=function(t){var e=[];return t.replace(/[a-fA-F0-9]{2}/g,function(t){e.push(parseInt(t,16))}),e}(s)),!Array.isArray(t))throw TypeError("value must be an array of bytes");if(!Array.isArray(s)||16!==s.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var o=r(s.concat(t));if(o[6]=15&o[6]|e,o[8]=128|63&o[8],i)for(var c=0;16>c;++c)i[a+c]=o[c];return i||p(o)};try{s.name=t}catch(t){}return s.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",s.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",s};function d(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function g(t,e,r,s,i,n){return d((a=d(d(e,t),d(s,n)))<<(o=i)|a>>>32-o,r);var a,o}function y(t,e,r,s,i,n,a){return g(e&r|~e&s,t,e,i,n,a)}function b(t,e,r,s,i,n,a){return g(e&s|r&~s,t,e,i,n,a)}function v(t,e,r,s,i,n,a){return g(e^r^s,t,e,i,n,a)}function x(t,e,r,s,i,n,a){return g(r^(e|~s),t,e,i,n,a)}var w=f("v3",48,function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=Array(e.length);for(var r=0;r<e.length;r++)t[r]=e.charCodeAt(r)}return function(t){var e,r,s,i=[],n=32*t.length;for(e=0;e<n;e+=8)r=255&t[e>>5]>>>e%32,s=parseInt("0123456789abcdef".charAt(15&r>>>4)+"0123456789abcdef".charAt(15&r),16),i.push(s);return i}(function(t,e){var r,s,i,n,a;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var o=1732584193,c=-271733879,h=-1732584194,p=271733878;for(r=0;r<t.length;r+=16)s=o,i=c,n=h,a=p,o=y(o,c,h,p,t[r],7,-680876936),p=y(p,o,c,h,t[r+1],12,-389564586),h=y(h,p,o,c,t[r+2],17,606105819),c=y(c,h,p,o,t[r+3],22,-1044525330),o=y(o,c,h,p,t[r+4],7,-176418897),p=y(p,o,c,h,t[r+5],12,1200080426),h=y(h,p,o,c,t[r+6],17,-1473231341),c=y(c,h,p,o,t[r+7],22,-45705983),o=y(o,c,h,p,t[r+8],7,1770035416),p=y(p,o,c,h,t[r+9],12,-1958414417),h=y(h,p,o,c,t[r+10],17,-42063),c=y(c,h,p,o,t[r+11],22,-1990404162),o=y(o,c,h,p,t[r+12],7,1804603682),p=y(p,o,c,h,t[r+13],12,-40341101),h=y(h,p,o,c,t[r+14],17,-1502002290),c=y(c,h,p,o,t[r+15],22,1236535329),o=b(o,c,h,p,t[r+1],5,-165796510),p=b(p,o,c,h,t[r+6],9,-1069501632),h=b(h,p,o,c,t[r+11],14,643717713),c=b(c,h,p,o,t[r],20,-373897302),o=b(o,c,h,p,t[r+5],5,-701558691),p=b(p,o,c,h,t[r+10],9,38016083),h=b(h,p,o,c,t[r+15],14,-660478335),c=b(c,h,p,o,t[r+4],20,-405537848),o=b(o,c,h,p,t[r+9],5,568446438),p=b(p,o,c,h,t[r+14],9,-1019803690),h=b(h,p,o,c,t[r+3],14,-187363961),c=b(c,h,p,o,t[r+8],20,1163531501),o=b(o,c,h,p,t[r+13],5,-1444681467),p=b(p,o,c,h,t[r+2],9,-51403784),h=b(h,p,o,c,t[r+7],14,1735328473),c=b(c,h,p,o,t[r+12],20,-1926607734),o=v(o,c,h,p,t[r+5],4,-378558),p=v(p,o,c,h,t[r+8],11,-2022574463),h=v(h,p,o,c,t[r+11],16,1839030562),c=v(c,h,p,o,t[r+14],23,-35309556),o=v(o,c,h,p,t[r+1],4,-1530992060),p=v(p,o,c,h,t[r+4],11,1272893353),h=v(h,p,o,c,t[r+7],16,-155497632),c=v(c,h,p,o,t[r+10],23,-1094730640),o=v(o,c,h,p,t[r+13],4,681279174),p=v(p,o,c,h,t[r],11,-358537222),h=v(h,p,o,c,t[r+3],16,-722521979),c=v(c,h,p,o,t[r+6],23,76029189),o=v(o,c,h,p,t[r+9],4,-640364487),p=v(p,o,c,h,t[r+12],11,-421815835),h=v(h,p,o,c,t[r+15],16,530742520),c=v(c,h,p,o,t[r+2],23,-995338651),o=x(o,c,h,p,t[r],6,-198630844),p=x(p,o,c,h,t[r+7],10,1126891415),h=x(h,p,o,c,t[r+14],15,-1416354905),c=x(c,h,p,o,t[r+5],21,-57434055),o=x(o,c,h,p,t[r+12],6,1700485571),p=x(p,o,c,h,t[r+3],10,-1894986606),h=x(h,p,o,c,t[r+10],15,-1051523),c=x(c,h,p,o,t[r+1],21,-2054922799),o=x(o,c,h,p,t[r+8],6,1873313359),p=x(p,o,c,h,t[r+15],10,-30611744),h=x(h,p,o,c,t[r+6],15,-1560198380),c=x(c,h,p,o,t[r+13],21,1309151649),o=x(o,c,h,p,t[r+4],6,-145523070),p=x(p,o,c,h,t[r+11],10,-1120210379),h=x(h,p,o,c,t[r+2],15,718787259),c=x(c,h,p,o,t[r+9],21,-343485551),o=d(o,s),c=d(c,i),h=d(h,n),p=d(p,a);return[o,c,h,p]}(function(t){var e,r=[];for(r[(t.length>>2)-1]=void 0,e=0;e<r.length;e+=1)r[e]=0;var s=8*t.length;for(e=0;e<s;e+=8)r[e>>5]|=(255&t[e/8])<<e%32;return r}(t),8*t.length))}),j=function(t,e,r){var s=e&&r||0;"string"==typeof t&&(e="binary"===t?Array(16):null,t=null);var i=(t=t||{}).random||(t.rng||n)();if(i[6]=64|15&i[6],i[8]=128|63&i[8],e)for(var a=0;16>a;++a)e[s+a]=i[a];return e||p(i)};function O(t,e,r,s){switch(t){case 0:return e&r^~e&s;case 1:return e^r^s;case 2:return e&r^e&s^r&s;case 3:return e^r^s;}}function S(t,e){return t<<e|t>>>32-e}var E=f("v5",80,function(t){var e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var s=unescape(encodeURIComponent(t));t=Array(s.length);for(var i=0;i<s.length;i++)t[i]=s.charCodeAt(i)}t.push(128);var n=t.length/4+2,a=Math.ceil(n/16),o=Array(a);for(i=0;i<a;i++){o[i]=Array(16);for(var c=0;16>c;c++)o[i][c]=t[64*i+4*c]<<24|t[64*i+4*c+1]<<16|t[64*i+4*c+2]<<8|t[64*i+4*c+3]}for(o[a-1][14]=8*(t.length-1)/Math.pow(2,32),o[a-1][14]=Math.floor(o[a-1][14]),o[a-1][15]=4294967295&8*(t.length-1),i=0;i<a;i++){for(var h=Array(80),p=0;16>p;p++)h[p]=o[i][p];for(p=16;80>p;p++)h[p]=S(h[p-3]^h[p-8]^h[p-14]^h[p-16],1);var l=r[0],u=r[1],m=r[2],f=r[3],d=r[4];for(p=0;80>p;p++){var g=Math.floor(p/20),y=S(l,5)+O(g,u,m,f)+d+e[g]+h[p]>>>0;d=f,f=m,m=S(u,30)>>>0,u=l,l=y}r[0]=r[0]+l>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+m>>>0,r[3]=r[3]+f>>>0,r[4]=r[4]+d>>>0}return[255&r[0]>>24,255&r[0]>>16,255&r[0]>>8,255&r[0],255&r[1]>>24,255&r[1]>>16,255&r[1]>>8,255&r[1],255&r[2]>>24,255&r[2]>>16,255&r[2]>>8,255&r[2],255&r[3]>>24,255&r[3]>>16,255&r[3]>>8,255&r[3],255&r[4]>>24,255&r[4]>>16,255&r[4]>>8,255&r[4]]})},function(t,e,r){"use strict";const s=r(11).Validator,i=r(20);let n=null;const a=function(t){return t&&Object.keys(t).forEach(e=>{void 0===t[e]&&delete t[e],"properties"===e&&t[e]&&0===Object.keys(t[e]).length&&delete t[e]}),t};var o=new s;o.addSchema(i.stepDefinitionSchema,i.stepDefinitionSchema.id),o.addSchema(i.importSchema,i.importSchema.id);class c{constructor(t,e){this.setSteps(t),this.setURL(e)}toObject(){return Array.isArray(this.steps)&&1===this.steps.length&&(this.steps=this.steps[0]),{steps:this.steps,url:this.url}}fromObject(t){if(Array.isArray(t)&&2===t.length)this.setSteps(t[0]),this.setURL(t[1]);else{if("object"!=typeof t)throw new Error("Object is not a valid import");this.setSteps(t.steps),this.setURL(t.url)}return this}addStep(t){return Array.isArray(this.steps)?this.steps.push(t):this.steps=[this.steps,t],this}getSteps(){return this.steps}setSteps(t){return Array.isArray(t)?this.steps=t:this.steps=t?[t]:[],this}getURL(){return this.url}setURL(t){return this.url=t,this}}c.prototype.dataType="Import";class h{constructor(t){this.setImports(t?t.map(t=>new c().fromObject(t)):[])}toObject(){return this.imports.map(function(t){return t.toObject()})}fromObject(t){if(!Array.isArray(t))throw new Error("Object is not a valid import list");for(let e=0;e<t.length;e++)"import_list"!==t[e]&&this.addImport(new c().fromObject(t[e]));return this}addImport(t){return this.imports.push(t),this}getImports(){return this.imports}setImports(t){return this.imports=t,this}}h.prototype.dataType="ImportList";class p{constructor(t,e,r){"object"==typeof t?this.setProperties(t):"object"==typeof e?(this.setId(t),this.setProperties(e)):(this.setId(t),this.setParent(e),this.setProperties(r||{})),this.assets||(this.assets=[])}toObject(){return a({properties:this.properties,id:this.getId(),parent:this.getParent(),assets:this.getAssets(),pre:this.getPre(),post:this.getPost(),location:this.getLocation(),locationAware:this.isLocationAware(),arContextLocation:this.getARContextLocation()})}fromObject(t){if(Array.isArray(t)&&1<t.length){if(this.setId(t[0]),2<t.length)this.setParent(t[1]),this.setProperties(t[2]);else{if(t[1]&&t[1].assets){let e=[];Object.entries(t[1].assets).forEach(t=>{const r=t[0],s=t[1];void 0===s.name&&(s.name=r),e.push(s)}),this.setAssets(e),delete t[1].assets}this.setProperties(t[1])}}else{if(!t)throw new Error("Object is not a valid step definition");var e=o.validate(t,i.stepDefinitionSchema);if(!e.valid){var r="";throw e.errors.forEach(t=>{r+=t.message+"; "}),new Error("Object is not a valid step definition "+r)}this.setId(t.id),this.setParent(t.parent),this.setProperties(t.properties||{}),this.setAssets(t.assets||[]),this.setPre(t.pre),this.setPost(t.post),this.setLocation(t.location),this.setLocationAware(t.locationAware),this.setARContextLocation(t.arContextLocation)}return this}fromSxsl(t){let e=n.parse(t).find(t=>"step_definition_list"===t[0])[1];if(e)return this.fromObject(e),this;throw new Error("Invalid SxSL definition for a step")}getId(){return this.id}setId(t){return this.id=t,this}getIndex(){return this.index}isLast(){return this.last}getParent(){return this.parent}setParent(t){return this.parent=t,this}getProperties(){return this.properties}listProperties(){return Object.keys(this.properties)}setProperties(t){return this.properties=t,this}getProperty(t){if(this.properties)return this.properties[t]}setProperty(t,e){return this.properties[t]=e,this}getLocation(){return this.location}setLocation(t){this.location=t}getARContextLocation(){return this.arContextLocation}setARContextLocation(t){this.arContextLocation=t}getAssets(){return this.assets}setAssets(t){this.assets=t}setPre(t){this.pre=t}getPre(){return this.pre}setPost(t){this.post=t}getPost(){return this.post}getRuntimeContext(){return this.runtimeContext}setRuntimeContext(t){this.runtimeContext=t}getDescription(){const t=this.assets&&this.assets.filter(t=>t&&"description"===t.name);return Promise.resolve(t&&t[0]&&t[0].value)}setDescription(t){this.assets||(this.assets=[]);let e=this.assets.filter(t=>"description"===t.name);return e&&e[0]&&(e=e[0]),e&&0!==e.length||(e={name:"description"},this.assets.push(e)),e.value=t,Promise.resolve(!0)}getMedia(){return this.assets.filter(t=>"media"===t.category)}getArContexts(){return this.assets.filter(t=>"context3d"===t.category&&"ar-context"===t.type)}get3DEffects(){return this.assets.filter(t=>"content3d"===t.category&&"3d-effect"===t.type)}setLocationAware(t){this.locationAware=t}isLocationAware(){return!!this.locationAware}getAnchors(){let t=[];const e=this.assets;for(const r in e){const s=e[r];"anchor"===s.type&&t.push(s)}return t}evaluate(t){!t&&this.runtimeContext&&(t=this.runtimeContext.runtimeEnvironment);let e=new p().fromObject({id:this.id,location:this.location,locationAware:this.locationAware,arContextLocation:this.arContextLocation,assets:this.assets,pre:this.pre,post:this.post,parent:this.getParent(),properties:function e(r){let s={};return Object.keys(r).forEach(i=>{let n=r[i];switch(typeof n){case"boolean":case"number":case"string":s[i]=n;break;case"object":s[i]=Array.isArray(n)?new u().fromObject(n).evaluate(t):e(n);break;default:s[i]=t[n];}}),s}(this.properties)});return e.setRuntimeContext(this.runtimeContext),e}}p.prototype.dataType="StepDefinition";class l{constructor(t){this.setSteps(t||[])}toObject(){return this.steps.map(function(t){return t.toObject()})}fromObject(t){if(Array.isArray(t)){this.setSteps([]);for(let e=0,r;e<t.length;e++){r=t[e];"step_definition_list"!==r&&(r instanceof p||(r=new p().fromObject(t[e])),this.addStep(r))}}else if(t)throw new Error("Object is not a valid step definition list");return this}addStep(t){return this.steps.push(t),this}getSteps(){return this.steps}setSteps(t){return this.steps=t,this}}l.prototype.dataType="StepDefinitionList";class u{constructor(t){t&&this.fromString(t)}toObject(){return this.definition}fromObject(t){return this.definition=t,this}fromString(t){let e=n.parse("set x = "+t+";"),r=[];for(let t=e.length-1;0<t;t--)if("statement_list"===e[t][0]){r=e[t];break}this.definition=r[1][2]}toString(){function t(t){return Array.isArray(t)&&"get"!==t[0]?"("+e(t)+")":e(t)}function e(e){if(Array.isArray(e)){if(2>e.length)throw new Error("Incorrect expression rank: "+e.length);let r=e[0],s=2<e.length?e[1]:void 0,i=s?e[2]:e[1];switch(r){case"add":return t(s)+" + "+t(i);case"and":return t(s)+" && "+t(i);case"div":return t(s)+" / "+t(i);case"eq":return t(s)+" == "+t(i);case"ge":return t(s)+" >= "+t(i);case"get":return i;case"gt":return t(s)+" > "+t(i);case"le":return t(s)+" <= "+t(i);case"lt":return t(s)+" < "+t(i);case"mod":return t(s)+" % "+t(i);case"mul":return t(s)+" * "+t(i);case"ne":return t(s)+" != "+t(i);case"neg":return"-"+t(i);case"not":return"!"+t(i);case"or":return t(s)+" || "+t(i);case"sub":return t(s)+" - "+t(i);default:throw new Error("Unrecognized operator: "+r);}}else switch(typeof e){case"boolean":case"number":return e.toString();case"string":return"\""+e+"\"";default:throw new Error("Unrecognized type of expression: "+typeof e);}}return e(this.definition)}evaluate(t){function e(t){if(Array.isArray(t))return r(t);switch(typeof t){case"boolean":case"number":case"string":return t;default:throw new Error("Unrecognized type of operand: "+typeof t);}}function r(r){if(!Array.isArray(r))return e(r);{if(2>r.length)throw new Error("Incorrect expression rank: "+r.length);let s=r[0],i=2<r.length?r[1]:void 0,n=i?r[2]:r[1];switch(s){case"add":return e(i)+e(n);case"and":return e(i)&&e(n);case"div":return e(i)/e(n);case"eq":return e(i)===e(n);case"ge":return e(i)>=e(n);case"get":return t[n];case"gt":return e(i)>e(n);case"le":return e(i)<=e(n);case"lt":return e(i)<e(n);case"mod":return e(i)%e(n);case"mul":return e(i)*e(n);case"ne":return e(i)!==e(n);case"neg":return-e(n);case"not":return!e(n);case"or":return e(i)||e(n);case"sub":return e(i)-e(n);default:throw new Error("Unrecognized operator: "+s);}}}return t||(t={}),r(this.definition)}}u.prototype.dataType="Expression";class m{toObject(){}fromObject(){return this}}class f{constructor(t){this.setStatements(t||[])}toObject(){let t=[];for(let e=0;e<this.statements.length;e++)t.push(this.statements[e].toObject());return t}fromObject(t){if(!Array.isArray(t))throw new Error("Object is not a valid statement list");{this.statements=[];let e=0;0<t.length&&"statement_list"===t[0]&&(e=1);for(let r=e;r<t.length;r++){let e=t[r],s=e.dataType;if(Array.isArray(e)&&0<e.length&&(s=e[0]),e instanceof m)this.addStatement(e);else{if(!s)throw console.error("Not a statement Object",e),new Error("Object in statement list is not a valid statement object");switch(s){case"call":case y.prototype.dataType:this.addStatement(new y().fromObject(e));break;case"condition_list":case v.prototype.dataType:this.addStatement(new v().fromObject(e));break;case"set":case x.prototype.dataType:this.addStatement(new x().fromObject(e));break;case"step":case w.prototype.dataType:this.addStatement(new w().fromObject(e));break;case"while":case j.prototype.dataType:this.addStatement(new j().fromObject(e));break;default:throw new Error("Unrecognized statement type: "+e[0]);}}}}return this}addStatement(t){return this.statements.push(t),this}getStatement(t){return t<this.statements.length?this.statements[t]:null}getStatements(){return this.statements}setStatements(t){if(t instanceof m)this.statements=[t];else if(Array.isArray(t))this.fromObject(t);else{if(!(t instanceof f))throw new Error("Statement list must be an array");this.statements=t}return this}}class d{constructor(t,e){this.setName(t||""),this.setExpression(e||new u)}toObject(){return{name:this.name,expression:this.expression.toObject(),dataType:this.dataType}}fromObject(t){if(Array.isArray(t)&&2===t.length)this.setName(t[0]),this.setExpression(new u().fromObject(t[1]));else{if("object"!=typeof t||t.dataType!==this.dataType)throw console.error("Bad parameter definition",t),new Error("Object is not a valid parameter definition");this.setName(t.name),this.setExpression(new u().fromObject(t.expression))}return this}getExpression(){return this.expression}setExpression(t){return this.expression=t instanceof u?t:new u(t),this}getName(){return this.name}setName(t){return this.name=t,this}}d.prototype.dataType="Parameter";class g{constructor(t){this.setParameters(t||[])}toObject(){let t=[];for(let e=0;e<this.parameters.length;e++)t.push(this.parameters[e].toObject());return t}fromObject(t){if(!Array.isArray(t))throw new Error("Object is not a valid parameter list");for(let e=0;e<t.length;e++)this.addParameter(new d().fromObject(t[e]));return this}addParameter(t){return this.parameters.push(t),this}listParameters(){return this.parameters}setParameters(t){return this.parameters=t,this}}g.prototype.dataType="ParameterList";class y extends m{constructor(t,e){super(),this.setURL(t),this.setParameterList(e||new g)}toObject(){return{dataType:this.dataType,url:this.url,paramList:this.paramList.toObject()}}fromObject(t){if(Array.isArray(t)&&1<t.length&&"call"===t[0])this.setURL(t[1]),2<t.length&&this.getParameterList().fromObject(t[2]);else{if("object"!=typeof t||t.dataType!==this.dataType&&"call"!==t.dataType)throw new Error("Object is not a valid step definition");this.setURL(t.url),this.getParameterList().fromObject(t.paramList)}return this}addParameter(t){return this.paramList.addParameter(t),this}getParameterList(){return this.paramList}setParameterList(t){if(t instanceof g)return this.paramList=t,this;if(Array.isArray(t)){this.paramList=new g;for(let e=0;e<t.length;e++)this.paramList.addParameter(t[e]);return this}if(t instanceof d)return this.paramList=new g,this.paramList.addParameter(t),this;throw new Error("Parameter list must be an array")}getURL(){return this.url}setURL(t){this.url=t}}y.prototype.dataType="CallStatement";class b{constructor(t,e){this.setExpression(t||new u),this.setStatements(e)}toObject(){return{dataType:this.dataType,expression:this.expression.toObject(),statementList:this.statementList.toObject()}}fromObject(t){if(Array.isArray(t)&&2===t.length)this.setExpression(new u().fromObject(t[0])),this.setStatements(new f().fromObject(t[1]));else{if("object"!=typeof t||t.dataType!==this.dataType&&"choice"!==t.dataType)throw console.error("Bad choice definition:",t),new Error("Object is not a valid choice definition");this.setExpression(new u().fromObject(t.expression)),this.setStatements(new f().fromObject(t.statementList))}return this}getExpression(){return this.expression}setExpression(t){return this.expression=t instanceof u?t:new u(t),this}addStatement(t){return this.statementList.addStatement(t),this}getStatementList(){return this.statementList}listStatements(){return this.statementList?this.statementList.getStatements():[]}setStatements(t){return this.statementList=t instanceof f?t:new f(t),this}}b.prototype.dataType="Choice";class v extends m{constructor(t){super(),this.setChoiceList(t||[])}toObject(){return{dataType:this.dataType,conditionList:this.choiceList.map(function(t){return t.toObject()})}}fromObject(t){if(Array.isArray(t)&&0<t.length&&"condition_list"===t[0])for(let e=1;e<t.length;e++)this.addChoice(new b().fromObject(t[e]));else{if("object"!=typeof t||t.dataType!==this.dataType&&"condition_list"!==t.dataType)throw new Error("Object is not a valid conditional statement definition");var e=this;t.conditionList.forEach(function(t){e.addChoice(new b().fromObject(t))})}return this}addChoice(t){return this.choiceList.push(t),this}getChoiceList(){return this.choiceList}setChoiceList(t){if(Array.isArray(t))return this.choiceList=t,this;if(t instanceof b)return this.choiceList=[t],this;throw new Error("Choice list must be an array")}}v.prototype.dataType="ConditionalStatement";class x extends m{constructor(t,e){super(),this.setVariable(t||""),this.setExpression(e||new u)}toObject(){return{dataType:this.dataType,variable:this.variable,expression:this.expression.toObject()}}fromObject(t){if(Array.isArray(t)&&3===t.length&&"set"===t[0])this.setVariable(t[1]),this.setExpression(new u().fromObject(t[2]));else{if("object"!=typeof t||t.dataType!==this.dataType&&"set"!==t.dataType)throw new Error("Object is not a valid set statement definition");this.setVariable(t.variable),this.setExpression(new u().fromObject(t.expression))}return this}getExpression(){return this.expression}setExpression(t){return this.expression=t instanceof u?t:new u(t),this}getVariable(){return this.variable}setVariable(t){return this.variable=t,this}}x.prototype.dataType="SetStatement";class w extends m{constructor(t){super(),this.setId(t)}toObject(){return{dataType:this.dataType,stepId:this.id}}fromObject(t){if(Array.isArray(t)&&2===t.length&&"step"===t[0])this.setId(t[1]);else{if("object"!=typeof t||t.dataType!==this.dataType&&"step"!==t.dataType)throw new Error("Object is not a valid step statement definition");this.setId(t.stepId)}return this}getId(){return this.id}setId(t){this.id=t}}w.prototype.dataType="StepStatement";class j extends m{constructor(t,e){super(),this.setExpression(t||new u),this.setStatements(e)}toObject(){return{dataType:this.dataType,expression:this.expression.toObject(),statementList:this.statementList.toObject()}}fromObject(t){if(Array.isArray(t)&&1<t.length&&"while"===t[0])this.setExpression(new u().fromObject(t[1])),2<t.length&&this.statementList.fromObject(t[2]);else{if("object"!=typeof t||t.dataType!==this.dataType&&"while"!==t.dataType)throw new Error("Object is not a valid set statement definition");this.setExpression(new u().fromObject(t.expression)),this.statementList.fromObject(t.statementList)}return this}getExpression(){return this.expression}setExpression(t){return this.expression=t instanceof u?t:new u(t),this}addStatement(t){return this.statementList.addStatement(t),this}getStatementList(){return this.statementList}listStatements(){return this.statementList?this.statementList.getStatements():[]}setStatements(t){return this.statementList=t instanceof f?t:new f(t),this}}j.prototype.dataType="WhileStatement";class O{constructor(t){this.setURI(t)}toObject(){return this.uri}fromObject(t){if(Array.isArray(t)&&0<t.length&&"extend"===t[0])1<t.length&&this.setURI(t[1]);else{if(!t||"string"!=typeof t.extend)throw new Error("Object is not a valid extend definition");this.uri=t}return this}getURI(){return this.uri}setURI(t){return this.uri=t,this}}O.prototype.dataType="Extend";class S{constructor(t){this.setId(t)}toObject(){return this.id}fromObject(t){if(Array.isArray(t)&&0<t.length&&"namespace"===t[0])1<t.length&&this.setId(t[1]);else{if("string"!=typeof t)throw new Error("Object is not a valid namespace declaration");this.setId(t)}return this}getId(){return this.id}setId(t){return this.id=t,this}}S.prototype.dataType="Namespace";class E{constructor(t){this.setVersion(t)}toObject(){return this.version}fromObject(t){if(Array.isArray(t)&&0<t.length&&"version"===t[0])1<t.length&&this.setVersion(t[1]);else{if("string"!=typeof t)throw new Error("Object is not a valid version declaration");this.version=t}return this}getVersion(){return this.version}setVersion(t){return this.version=t,this}}E.prototype.dataType="Version";class A{constructor(t){this.setProperties(t)}toObject(){return this.properties}fromObject(t){if(Array.isArray(t)&&0<t.length&&"properties"===t[0])1<t.length&&this.setProperties(t[1]);else{if("object"!=typeof t)throw new Error("Object is not a valid version declaration");this.setProperties(t)}return this}getProperties(){return this.properties}setProperties(t){return this.properties=t,this}}A.prototype.dataType="Properties";class L{constructor(){this.setVersion(new E),this.setNamespace(new S),this.setExtend(new O),this.setImportList(new h),this.setStepDefinitions(new l),this.setStatements(new f),this.setProperties(new A({}))}toObject(){return a({dataType:this.dataType,extend:this.getExtend().toObject(),version:this.getVersion().toObject(),namespace:this.getNamespace().toObject(),importList:this.getImportList().toObject(),stepDefinitionList:this.stepDefinitionList.toObject(),properties:this.properties.toObject(),statementList:this.getStatementList().toObject(),title:this.title,thumbnail:this.getThumbnail()})}fromObject(t){if(Array.isArray(t)&&0<t.length&&"process"===t[0])for(let e=1,r;e<t.length;e++){r=t[e];if(!(Array.isArray(r)&&0<r.length))throw new Error("Object is not a valid process definition");switch(r[0]){case"extend":this.extend.fromObject(r);break;case"import_list":this.importList.fromObject(r);break;case"namespace":this.namespace.fromObject(r);break;case"statement_list":this.statementList.fromObject(r);break;case"step_definition_list":this.stepDefinitionList.fromObject(r);break;case"version":this.version.fromObject(r);break;case"properties":r&&r[1]&&r[1].title&&(this.setTitle(r[1].title),delete r[1].title),r&&r[1]&&r[1].thumbnail&&(this.setThumbnail(r[1].thumbnail),delete r[1].thumbnail),this.properties.fromObject(r);break;default:throw new Error("Unrecognized object type in process definition: "+r[0]);}}else{if(!t)throw new Error("Object is not a valid process definition");var e=o.validate(t,i.procedureSchema);if(!e.valid){var r="";throw e.errors.forEach(t=>{r+=t.message+"; "}),new Error("Object is not a valid process definition: "+r)}this.setExtend(t.extend),this.setVersion(t.version),this.setNamespace(t.namespace),this.setImportList(t.importList),this.stepDefinitionList.fromObject(t.stepDefinitionList),this.setProperties(t.properties),this.setStatements(t.statementList),this.setTitle(t.title),this.setThumbnail(t.thumbnail)}return this}toJSON(){return JSON.stringify(this.toObject())}fromJSON(t){return this.fromObject(JSON.parse(t)),this}fromSxsl(t){return this.fromObject(n.parse(t)),this}getExtend(){return this.extend}setExtend(t){return this.extend=t instanceof O?t:new O(t),this}addImport(t){return this.importList.addImport(t),this}getImportList(){return this.importList}setImportList(t){if(void 0===t)return this;if(t instanceof h)return this.importList=t,this;if(t instanceof c)return this.importList=new h,this.importList.addImport(t),this;if(Array.isArray(t)){this.importList=new h;for(let e=0;e<t.length;e++)this.addImport(new c().fromObject(t[e]));return this}if("object"==typeof t&&t.importList){this.importList=new h;for(let e=0;e<t.importList.length;e++)this.addImport(t.importList[e]);return this}throw new Error("Import list must be an array")}getNamespace(){return this.namespace}setNamespace(t){return this.namespace=t instanceof S?t:new S(t),this}getStepDefinition(t){for(let e=0,r;e<this.stepDefinitionList.length;e++){r=this.stepDefinitionList[e];if(r.getId()===t)return r}return null}listStepDefinitions(){return this.stepDefinitionList?this.stepDefinitionList.getSteps():[]}addStepDefinition(t){return this.stepDefinitionList.addStep(t),this}setStepDefinitions(t){if(t instanceof l)return this.stepDefinitionList=t,this;if(t instanceof p)return this.stepDefinitionList=new l,this.stepDefinitionList.addStep(t),this;if(Array.isArray(t)){this.stepDefinitionList=new l;for(let e=0;e<t.length;e++)this.stepDefinitionList.addStep(t[e]);return this}throw new Error("Step definition list must be an array")}addStatement(t){return this.statementList.addStatement(t),this}getStatementList(){return this.statementList}listStatements(){return this.statementList?this.statementList.getStatements():[]}setStatements(t){return this.statementList=t instanceof f?t:new f(t),this}getVersion(){return this.version}setVersion(t){return this.version=t instanceof E?t:new E(t),this}getProperties(){return this.properties.getProperties()}setProperties(t){return this.properties=t instanceof A?t:new A(t),this}getTitle(){return Promise.resolve(this.title)}setTitle(t){this.title=t}getThumbnail(){return this.thumbnail}setThumbnail(t){return this.thumbnail=t,this}getProject(){return this.project}setProject(t){return this.project=t,this}getCurrentStepIndex(){return Promise.resolve(this.runtimeHistoryIndex)}getCurrentStep(){return Promise.resolve(0<=this.runtimeHistoryIndex?this.runtimeHistory[this.runtimeHistoryIndex]:null)}getPreviousStep(){return Promise.resolve(0<this.runtimeHistoryIndex?this.runtimeHistory[--this.runtimeHistoryIndex]:null)}getNextStep(){return this.gotoStepAtIndex(this.runtimeHistoryIndex+1)}gotoStepAtIndex(t){return this.getStepAtIndex(t,!0)}getStepAtIndex(t,e){return 0>t?Promise.resolve(null):this.evaluateSteps(t+2).then(r=>r||this.runtimeHistory.length>t?(e&&(this.runtimeHistoryIndex=t),this.runtimeHistory[t]):null).catch(r=>{if(this.runtimeHistory.length>t)return e&&(this.runtimeHistoryIndex=t),this.runtimeHistory[t];throw r})}getStepCount(){return this.evaluateSteps().then(()=>this.runtimeHistory.length)}getSteps(t){return this.evaluateSteps(void 0!==t?t+1:void 0).then(()=>this.runtimeHistory).catch(e=>{if(void 0!==t&&this.runtimeHistory.length>=t)return this.runtimeHistory;throw e})}evaluateSteps(t){return void 0!==t&&this.runtimeHistory.length>=t?Promise.resolve(!0):this.evaluateAnotherStep().then(e=>null!==e&&this.evaluateSteps(t))}evaluateAnotherStep(){for(;0<this.runtimeStack.length;){let t=this.runtimeStack[this.runtimeStack.length-1],e=t.statementList.getStatement(t.statementIndex++);if(e){if(e instanceof w){let r=t.procedure.runtimeSteps[e.getId()].evaluate(t.procedure.runtimeEnvironment);return r.index=this.runtimeHistory.length,this.runtimeHistory.push(r),Promise.resolve(r)}if(e instanceof v){let r=e.getChoiceList();for(let e=0,s;e<r.length;e++){s=r[e];if(s.getExpression().evaluate(t.procedure.runtimeEnvironment)){this.runtimeStack.push({statementIndex:0,statementList:s.getStatementList(),procedure:t.procedure});break}}}else{if(e instanceof y){let r=e.getURL(),s=e.getParameterList().listParameters(),i={};for(let e=0,r;e<s.length;e++){r=s[e];i[r.getName()]=r.getExpression().evaluate(t.procedure.runtimeEnvironment)}let n=new L;return n.setProject(this.getProject()),n.runtimeEnvironment=i,n.load(r,this.connection).then(t=>t.start()).then(t=>(this.runtimeStack.push({statementIndex:0,statementList:t.getStatementList(),procedure:t}),this.evaluateAnotherStep()))}if(e instanceof x)t.procedure.runtimeEnvironment[e.getVariable()]=e.getExpression().evaluate(t.procedure.runtimeEnvironment);else{if(!(e instanceof j))return console.error("Could not parse the statement",e),Promise.reject("Unrecognized statement class");e.getExpression().evaluate(t.procedure.runtimeEnvironment)&&(t.statementIndex--,this.runtimeStack.push({statementIndex:0,statementList:e.getStatementList(),procedure:t.procedure}))}}}else this.runtimeStack.pop()}return 0<this.runtimeHistory.length&&(this.runtimeHistory[this.runtimeHistory.length-1].last=!0),Promise.resolve(null)}getEvaluatedStep(t,e){return this.runtimeSteps[this.qualifyName(t)].evaluate(e)}loadResource(t,e){e||(e="application/json");let r=this.connection;if(!r&&this.project){let t=this.project.getManager();t&&(r=t.connection,this.connection=r)}if(t.startsWith("urn:"))return r.lookup(t).then(t=>this.loadResource(t));if(t.startsWith("/"))t.includes("/projects/")||(t=r.getCmsBaseUrl()+"projects"+t);else if(-1===t.indexOf("/")){let s=this.getProject();if(s){let i=s.getMetadata();i&&i.id&&(t="application/vnd.ptc.procedure+json"===e?r.getCmsBaseUrl()+"projects/"+i.id+"/procedures/"+t:r.getCmsBaseUrl()+"projects/"+i.id+"/assets/"+t)}}return r.get(t,e)}load(t,e){return e&&this.setConnection(e),this.loadResource(t,"application/vnd.ptc.procedure+json").then(t=>(this.fromJSON(t),this))}setConnection(t){this.connection=t}qualifyName(t){return"{"!==t[0]&&0>t.indexOf(".")?this.runtimeNamespace+t:t}convertToOffline(){let t=new L;t.fromJSON(this.toJSON());const e={},r={};function s(t,s){if(Object.prototype.hasOwnProperty.call(r,s))return r[s];let i=function(t){return Object.prototype.hasOwnProperty.call(e,t)},n=t.generateOfflineNameForURL(s,i);if(i(n))throw new Error("generateOfflineNameForURL returned existing offline name: "+n);return e[n]=s,r[s]=n,n}const i=this.getThumbnail();return"string"==typeof i&&i&&t.setThumbnail(s(this,i)),t.listStepDefinitions().forEach(t=>{t.arContextLocation&&t.arContextLocation.context&&(t.arContextLocation.context=s(this,t.arContextLocation.context)),t.getMedia().forEach(t=>{"string"==typeof t.url&&t.url&&(t.url=s(this,t.url))}),t.setLocationAware(!1)}),{procedure:t.toJSON(),resourceMap:e}}generateOfflineNameForURL(t,e){function r(){let t="";for(let e=0;16>e;e++)t+=(Math.floor(Math.random()*Math.floor(256))+256).toString(16).substring(1);return t}const s=function(t){let e=t;const r=e.indexOf("?");-1!==r&&(e=e.substring(0,r));const s=e.lastIndexOf("/");-1!==e&&(e=e.substring(s+1));const i=e.lastIndexOf(".");return-1===i?"":e.substring(i)}(t);let i=r()+s;for(;e(i);)i=r()+s;return i}start(t,e){return t&&(this.setConnection?this.setConnection(t):e||(e=t)),e||(e={}),this.runtimeEnvironment=e,this.runtimeHistory=[],this.runtimeHistoryIndex=-1,this.runtimeStack=[],this.runtimeSteps={},this.runtimeStack.push({statementIndex:0,statementList:new f,procedure:this}),this.runtimeNamespace=this.getNamespace().getId(),this.runtimeNamespace&&""!==this.runtimeNamespace?this.runtimeNamespace+=".":this.runtimeNamespace="",new Promise((t,e)=>{let r=this.getExtend().getURI();r?(this.parentProcedure=new L,this.parentProcedure.load(r,this.connection).then(t=>t.start(this.connection)).then(e=>{Object.keys(e.runtimeSteps).forEach(t=>{this.runtimeSteps[t]=e.runtimeSteps[t]}),this.runtimeStack[0].statementList=new f(e.listStatements().concat(this.listStatements())),t(this)}).catch(t=>{e(t)})):(this.runtimeStack[0].statementList=new f(this.listStatements()),t(this))}).then(()=>{let t=this.getImportList().getImports(),e=[];for(let r=0;r<t.length;r++){let s=t[r],i=new L;i.runtimeImport=s,e.push(i.load(s.getURL(),this.connection).then(t=>t.start()).then(t=>{let e=t.runtimeImport.getSteps(),r=-1!==e.indexOf("*"),s=Object.keys(t.runtimeSteps);for(let i=0,n;i<s.length;i++){n=s[i];(r||-1!==e.indexOf(n))&&(this.runtimeSteps[n]=t.runtimeSteps[n])}}))}if(0<e.length)return Promise.all(e)}).then(()=>{try{let t=this;return this.listStepDefinitions().forEach(e=>{this.runtimeSteps[this.qualifyName(e.getId())]=function(t,e){let r={},s=e.getParent(),i={},n={};if(s&&""!==s){if(s=t.qualifyName(s),n=t.runtimeSteps[s],!n)throw new Error("Undefined parent step: "+s);i=n.getProperties()}let o=e.getProperties(),c=[];if(n.assets||e.assets){e.assets&&(c=c.concat(e.assets)),n.assets&&(c=c.concat(n.assets));const t=[];c=c.filter(e=>!t.includes(e.name)&&(t.push(e.name),!0))}r=Object.assign(r,i,o);let h=new p().fromObject(Object.assign({},n,a(e),{assets:c,parent:s,properties:r,id:t.qualifyName(e.getId())}));return h.setRuntimeContext(t),h}(t,e)}),this}catch(t){return Promise.reject(t)}})}}L.prototype.dataType="Procedure",e.CallStatement=y,e.Choice=b,e.ConditionalStatement=v,e.Expression=u,e.Import=c,e.Parameter=d,e.ParameterList=g,e.Procedure=L,e.SetStatement=x,e.StepDefinition=p,e.StepDefinitionList=l,e.StepStatement=w,e.StatementList=f,e.Version=E,e.WhileStatement=j,e.MIMETYPE_PROCEDURE="application/vnd.ptc.procedure+json",e.setParser=function(t){n=t}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){const s=r(7),i=r(4);i.setParser(r(21).parser);const n=r(23),a=r(3).v1;e=Object.assign(e,s,i,n,{uuid:a})},function(t,e,r){"use strict";const s=r(8),{Procedure:i,StepDefinition:n,MIMETYPE_PROCEDURE:a}=r(4),o=r(3).v1;s.define({"application/pvz":["pvz"],"application/vnd.ptc.room+binary":["room"]});class c{constructor(t,e){this.setURL(t),this.setMetadata(e)}getMetadata(){return this.metadata}setMetadata(t){this.metadata=t}getURL(){return this.url}setURL(t){this.url=t}}class h extends c{constructor(t,e,r){super(t,e),this.setData(r),t&&this.setName(t.substr(t.lastIndexOf("/")+1))}getData(){return this.data}setData(t){return this.data=t,this}getMediaType(){return this.mediaType}setMediaType(t){this.mediaType=t}getName(){return this.name}setName(t){return this.name=t,t&&!this.mediaType&&this.setMediaType(s.getType(t)),this}getDefaultUrl(){let t=this.getName();t||(t=o(),this.setName(t));let e="";return this.getMetadata()&&this.getMetadata().capture&&(e=this.getMetadata().capture+"/"),"/assets/"+e+t}}class p extends i{constructor(t){super(),t&&(this.setURL(t),this.setId(t.substr(t.lastIndexOf("/")+1)))}getId(){return this.id}setId(t){return this.id=t,this}getURL(){return this.url}setURL(t){this.url=t}getDefaultUrl(){let t=this.getId();return t||(t=o(),this.setId(t)),"/procedures/"+t}getURN(){return this.urn}setURN(t){this.urn=t}}class l extends c{constructor(t,e,r){super(t,e),this.setData(r)}getData(){return this.data}setData(t){return this.data=t,this}}class u extends n{constructor(t,e,r){super(t,e,r)}getURL(){return this.url}setURL(t){this.url=t}getDefaultUrl(){let t=this.getId();return t||(t=o(),this.setId(t)),"/steps/"+t}}class m extends c{constructor(t,e,r){super(e,r),this.setManager(t)}getManager(){return this.manager}setManager(t){this.manager=t}getResource(t,e={}){return t.startsWith("/")&&(t=t.substr(1)),this.manager.getResourceByURL(this.getURL()+"/"+t,e)}getResourceById(t,e="procedure",r="",s){return r?this.getResource(`${e}s/${r}/${t}`,s):this.getResource(`${e}s/${t}`,s)}getResourceMetadata(t,e){const r=this.getURL()+`/${e}s/${t}/.properties`;return this.manager.connection.get(r,"application/json")}patchResourceMetadata(t,e){let r=this.getResourceUrl(t);return r+="/.properties",this.manager.connection.patch(r,"application/json",JSON.stringify(e)).then(()=>t)}getAccess(t,e,r){const s=this.getURL()+`/${e}s/${encodeURI(t)}/.properties/.access/${r}`;return this.manager.connection.get(s,"application/json")}setAccess(t,e,r,s,i){const n=this.getURL()+`/${e}s/${encodeURI(t)}/.properties/.access/${r}/${encodeURI(s)}`,a={permission:i};return this.manager.connection.put(n,"application/json",JSON.stringify(a))}removeAccess(t,e,r,s){const i=this.getURL()+`/${e}s/${encodeURI(t)}/.properties/.access/${r}/${encodeURI(s)}`;return this.manager.connection.delete(i)}checkResourceById(t,e="procedure",r=""){return this.getResourceById(t,e,r,{method:"head"}).then(()=>!0,t=>{if(404===t.status)return!1;throw t})}deleteResource(t){let e=t.getURL?t.getURL():null;return e?this.manager.connection.delete(e):Promise.reject("Resource does not have a URL")}listResources(t,e,r){if(t){let s=this.getURL()+"/"+t;r||(r=new URLSearchParams);let i=s;return e&&r.set("subtype",e),r.toString()&&(i=i+"?"+r.toString()),this.manager.connection.get(i,"application/json").then(e=>{const r=Array.isArray(e)?e:e.items;let i=[];return"procedures"===t?r.forEach(t=>{let e=s+"/"+t.id;try{let r=new p(e);r.setProperties(t),r.setTitle(t.title),r.setThumbnail(t.thumbnail),i.push(r)}catch(t){console.error(t)}}):i=r.map(t=>(t.url.startsWith("/")||(t.url=this.getURL()+"/"+t.url),this.resourceFactory(t))),Promise.all(i)})}{const t=["assets","procedures","publications","steps"];let e=[];for(let r=0;r<t.length;r++)e.push(this.listResources(t[r]));return Promise.all(e).then(t=>{let e=[];for(let r=0;r<t.length;r++)e=e.concat(t[r]);return e})}}searchResources(t,e,r){r||(r=new URLSearchParams),[].concat(t).forEach(t=>{r.append("type",t)}),[].concat(e).forEach(t=>{r.append("tag",t)});let s=this.manager.connection.getCmsBaseUrl()+"search?"+r.toString();return this.manager.connection.get(s,"application/json").then(t=>(t&&t.items||[]).map(t=>this.resourceFactory(t)))}resourceFactory(t){if("object"!=typeof t)return t;switch(t.resourcetype){case"assets":return new h(t.url,t);case"procedures":return new p(t.url,t);case"steps":return new u(t.url,t);default:return new c(t.url,t);}}getResourceUrl(t){let e=t.getURL?t.getURL():null;return!e&&t.getDefaultUrl&&(e=this.getURL()+t.getDefaultUrl(),t.setURL(e)),e}storeResource(t,e={}){let r=this.getResourceUrl(t),s=null,o=null,c=e.urlParams||new URLSearchParams;const p=(t,e)=>Object.keys(t).includes(e);["title","category","description","subtype","thumbnail","tags"].forEach(e=>{let r;if(p(t,e)?r=t[e]||"":t.getProperties&&p(t.getProperties()||{},e)?r=t.getProperties()[e]||"":t.getMetadata&&p(t.getMetadata()||{},e)&&(r=t.getMetadata()[e]||""),Array.isArray(r)){const t=e.replace(/s$/,"");r.forEach(e=>c.append(t,e))}else void 0!==r&&c.set(e,r)}),e&&e.transform&&c.set("transform",e.transform);const l=c.toString();if(l&&!r.includes("?")&&(r=r+"?"+l),t instanceof h)s=t.getMediaType(),o=t.getData();else if(t instanceof i)s=a,o=JSON.stringify(t.toObject());else{if(!(t instanceof n))return Promise.reject("Unsupported resource class");s=a,o=JSON.stringify(t.toObject())}const u=this.manager.connection.calculateOptions({method:"PUT",headers:{"Content-Type":s},body:o});return t.correlationId=u.headers?u.headers["x-correlation-id"]:void 0,this.manager.connection.fetch(r,u,!0,e.fetch)}setResourceTag(t,e){let r=this.getResourceUrl(t);r+="/.properties";let s={tags:e};return this.manager.connection.put(r,"application/json",JSON.stringify(s)).then(()=>t)}publish(t){let e=this.getURL()+"/publications";return t?this.manager.connection.post(e,"application/json",JSON.stringify(t)):this.manager.connection.post(e,"application/json","{}")}unpublish(t){const e=this.getURL()+"/publications/";return this.manager.connection.get(e+"?resourceid="+t,"application/json").then(r=>{if(r.items&&r.items[0]){const t=r.items[0].id;return this.manager.connection.delete(e+t)}return Promise.reject("Publication not found for id: "+t)})}}e.CMSAsset=h,e.CMSProcedure=p,e.CMSProject=m,e.CMSProjectManager=class{constructor(t){this.setConnection(t)}getConnection(){return this.connection}setConnection(t){this.connection=t}createProject(t){let e=t.id;e||(e=o(),t.id=e);let r=this.connection.getCmsBaseUrl()+"projects/"+e;return this.connection.put(r,"application/json",JSON.stringify(t)).then(()=>new m(this,r,t),t=>{console.error("Error creating project",t)})}deleteProject(t){return this.connection.delete(t.getURL())}getProjectById(t){let e=this.connection.getCmsBaseUrl()+"projects/"+t;return this.connection.head(e).then(()=>new m(this,e))}getResource(t){let e=t.getURL();if(e)return this.getResourceByURL(e);{let e=t.getURN();return e?this.getResourceByURN(e):Promise.reject(new Error("400: Empty reference"))}}getResourceByURL(t,e={}){const r=this.connection.calculateOptions(e),s=e.method||"get",i=["^/.+/cms/projects/[^/]+/assets/[^/]","^/.+/cms/projects/[^/]+/(published/procedures%2F|procedures/)[^/]+$","^/.+/cms/projects/[^/]+/publications/[^/]+$","^/.+/cms/projects/[^/]+/steps/[^/]+$"],n=["assets","procedures","publications","steps"];let o=0;for(;o<i.length&&!new RegExp(i[o]).test(t);)o++;if(!(o<i.length))return Promise.reject(new Error("Invalid resource URL: "+t));switch(n[o]){case"assets":return this.connection[s](t,void 0,r).then(e=>{if("head"===s.toLowerCase())return;let r=new h(t);return r.setData(e),r});case"procedures":return this.connection[s](t,a,r).then(e=>{if("head"===s.toLowerCase())return;let i=new p(t);return e=JSON.parse(e),i.fromObject(e),i.correlationId=r.headers["x-correlation-id"],i});case"publications":return this.connection[s](t,void 0,r).then(e=>{if("head"===s.toLowerCase())return;let r=new l(t);return r.setData(e),r});case"steps":return this.connection[s](t,a,r).then(e=>{if("head"===s.toLowerCase())return;let r=new u(t);return r.fromSxsl(e.toString()),r});}}getResourceByURN(t){return this.connection.lookup(t).then(t=>this.getResourceByURL(this.connection.getCmsBaseUrl()+t))}listProjects(){return this.connection.get(this.connection.getCmsBaseUrl()+"projects","application/json").then(t=>{let e=[];for(let r=0,s;r<t.length;r++){s=t[r];e.push(new m(this,this.connection.getCmsBaseUrl()+"projects/"+s.id,s))}return e})}},e.CMSPublication=l,e.CMSReference=class{constructor(t,e){this.setURL(t),this.setURN(e)}getURL(){return this.url}setURL(t){this.url=t}getURN(){return this.urn}setURN(t){this.urn=t}},e.CMSResource=c,e.CMSStepDefinition=u,e.MIMETYPE_PROCEDURE=a,e.MIMETYPE_EXPERIENCE="application/vnd.ptc.experience+json",e.mime=s},function(t,e,r){"use strict";var s=r(9);t.exports=new s(r(10))},function(t,e,r){"use strict";function s(){this._types=Object.create(null),this._extensions=Object.create(null);for(var t=0;t<arguments.length;t++)this.define(arguments[t]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}s.prototype.define=function(t,e){for(var r in t){var s=t[r].map(function(t){return t.toLowerCase()});r=r.toLowerCase();for(var i=0;i<s.length;i++){if("*"!=(n=s[i])[0]){if(!e&&n in this._types)throw new Error("Attempt to change mapping for \""+n+"\" extension from \""+this._types[n]+"\" to \""+r+"\". Pass `force=true` to allow this, otherwise remove \""+n+"\" from the list of extensions for \""+r+"\".");this._types[n]=r}}if(e||!this._extensions[r]){var n=s[0];this._extensions[r]="*"!=n[0]?n:n.substr(1)}}},s.prototype.getType=function(t){var e=(t=t+"").replace(/^.*[/\\]/,"").toLowerCase(),r=e.replace(/^.*\./,"").toLowerCase(),s=e.length<t.length;return(r.length<e.length-1||!s)&&this._types[r]||null},s.prototype.getExtension=function(t){return(t=/^\s*([^;\s]*)/.test(t)&&RegExp.$1)&&this._extensions[t.toLowerCase()]||null},t.exports=s},function(t,e){t.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomsvc+xml":["atomsvc"],"application/bdoc":["bdoc"],"application/ccxml+xml":["ccxml"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma","es"],"application/emma+xml":["emma"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-diff+xml":["xdf"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/ktx":["ktx"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},function(t,e,r){"use strict";var s=t.exports.Validator=r(12);t.exports.ValidatorResult=r(0).ValidatorResult,t.exports.ValidationError=r(0).ValidationError,t.exports.SchemaError=r(0).SchemaError,t.exports.SchemaScanResult=r(2).SchemaScanResult,t.exports.scan=r(2).scan,t.exports.validate=function(t,e,r){return new s().validate(t,e,r)}},function(t,e,r){"use strict";var s=r(1),i=r(19),n=r(0),a=r(2).scan,o=n.ValidatorResult,c=n.SchemaError,h=n.SchemaContext,p=function t(){this.customFormats=Object.create(t.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(u),this.attributes=Object.create(i.validators)};function l(t){var e="string"==typeof t?t:t.$ref;return"string"==typeof e&&e}p.prototype.customFormats={},p.prototype.schemas=null,p.prototype.types=null,p.prototype.attributes=null,p.prototype.unresolvedRefs=null,p.prototype.addSchema=function(t,e){var r=this;if(!t)return null;var s=a(e||"/",t),i=e||t.id;for(var n in s.id)this.schemas[n]=s.id[n];for(var n in s.ref)this.unresolvedRefs.push(n);return this.unresolvedRefs=this.unresolvedRefs.filter(function(t){return void 0===r.schemas[t]}),this.schemas[i]},p.prototype.addSubSchemaArray=function(t,e){if(Array.isArray(e))for(var r=0;r<e.length;r++)this.addSubSchema(t,e[r])},p.prototype.addSubSchemaObject=function(t,e){if(e&&"object"==typeof e)for(var r in e)this.addSubSchema(t,e[r])},p.prototype.setSchemas=function(t){this.schemas=t},p.prototype.getSchema=function(t){return this.schemas[t]},p.prototype.validate=function(t,e,r,i){r||(r={});var n=r.propertyName||"instance",o=s.resolve(r.base||"/",e.id||"");if(!i){(i=new h(e,r,n,o,Object.create(this.schemas))).schemas[o]||(i.schemas[o]=e);var p=a(o,e);for(var l in p.id){var u=p.id[l];i.schemas[l]=u}}if(e){var m=this.validateSchema(t,e,r,i);if(!m)throw new Error("Result undefined");return m}throw new c("no schema specified",e)},p.prototype.validateSchema=function(t,e,r,s){var a,p=new o(t,e,r,s);if("boolean"==typeof e)!0===e?e={}:!1===e&&(e={type:[]});else if(!e)throw new Error("schema is undefined");if(e.extends)if(Array.isArray(e.extends)){var u={schema:e,ctx:s};e.extends.forEach(this.schemaTraverser.bind(this,u)),e=u.schema,u.schema=null,u.ctx=null,u=null}else e=n.deepMerge(e,this.superResolve(e.extends,s));if(a=l(e)){var m=this.resolve(e,a,s),f=new h(m.subschema,r,s.propertyPath,m.switchSchema,s.schemas);return this.validateSchema(t,m.subschema,r,f)}var d=r&&r.skipAttributes||[];for(var g in e)if(!i.ignoreProperties[g]&&0>d.indexOf(g)){var y=null,b=this.attributes[g];if(b)y=b.call(this,t,e,r,s);else if(!1===r.allowUnknownAttributes)throw new c("Unsupported attribute: "+g,e);y&&p.importErrors(y)}if("function"==typeof r.rewrite){var v=r.rewrite.call(this,t,e,r,s);p.instance=v}return p},p.prototype.schemaTraverser=function(t,e){t.schema=n.deepMerge(t.schema,this.superResolve(e,t.ctx))},p.prototype.superResolve=function(t,e){var r;return(r=l(t))?this.resolve(t,r,e).subschema:t},p.prototype.resolve=function(t,e,r){if(e=r.resolve(e),r.schemas[e])return{subschema:r.schemas[e],switchSchema:e};var i=s.parse(e),a=i&&i.hash,o=a&&a.length&&e.substr(0,e.length-a.length);if(!o||!r.schemas[o])throw new c("no such schema <"+e+">",t);var h=n.objectGetPath(r.schemas[o],a.substr(1));if(void 0===h)throw new c("no such schema "+a+" located in <"+o+">",t);return{subschema:h,switchSchema:e}},p.prototype.testType=function(t,e,r,s,i){if("function"==typeof this.types[i])return this.types[i].call(this,t);if(i&&"object"==typeof i){var n=this.validateSchema(t,i,r,s);return void 0===n||!(n&&n.errors.length)}return!0};var u=p.prototype.types={};u.string=function(t){return"string"==typeof t},u.number=function(t){return"number"==typeof t&&isFinite(t)},u.integer=function(t){return"number"==typeof t&&0==t%1},u.boolean=function(t){return"boolean"==typeof t},u.array=function(t){return Array.isArray(t)},u.null=function(t){return null===t},u.date=function(t){return t instanceof Date},u.any=function(t){return!0},u.object=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&!(t instanceof Date)},t.exports=p},function(t,e,r){(function(t,s){var i;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(n){e&&e.nodeType,t&&t.nodeType;var a="object"==typeof s&&s;a.global!==a&&a.window!==a&&a.self;var o,c=2147483647,h=/^xn--/,p=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,u={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,f=String.fromCharCode;function d(t){throw new RangeError(u[t])}function g(t,e){for(var r=t.length,s=[];r--;)s[r]=e(t[r]);return s}function y(t,e){var r=t.split("@"),s="";return 1<r.length&&(s=r[0]+"@",t=r[1]),s+g((t=t.replace(l,".")).split("."),e).join(".")}function b(t){for(var e,r,s=[],i=0,n=t.length;i<n;)55296<=(e=t.charCodeAt(i++))&&56319>=e&&i<n?56320==(64512&(r=t.charCodeAt(i++)))?s.push(((1023&e)<<10)+(1023&r)+65536):(s.push(e),i--):s.push(e);return s}function v(t){return g(t,function(t){var e="";return 65535<t&&(e+=f(55296|1023&(t-=65536)>>>10),t=56320|1023&t),e+=f(t)}).join("")}function x(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function w(t,e,r){var s=0;for(t=r?m(t/700):t>>1,t+=m(t/e);455<t;s+=36)t=m(t/35);return m(s+36*t/(t+38))}function j(t){var e,r,s,i,n,a,o,h,p,l,u,f=[],g=t.length,y=0,b=128,x=72;for(0>(r=t.lastIndexOf("-"))&&(r=0),s=0;s<r;++s)128<=t.charCodeAt(s)&&d("not-basic"),f.push(t.charCodeAt(s));for(i=0<r?r+1:0;i<g;){for(n=y,a=1,o=36;i>=g&&d("invalid-input"),(36<=(h=10>(u=t.charCodeAt(i++))-48?u-22:26>u-65?u-65:26>u-97?u-97:36)||h>m((c-y)/a))&&d("overflow"),y+=h*a,!(h<(p=o<=x?1:o>=x+26?26:o-x));o+=36)a>m(c/(l=36-p))&&d("overflow"),a*=l;x=w(y-n,e=f.length+1,0==n),m(y/e)>c-b&&d("overflow"),b+=m(y/e),y%=e,f.splice(y++,0,b)}return v(f)}function O(t){var e,r,s,i,n,a,o,h,p,l,u,g,y,v,j,O=[];for(g=(t=b(t)).length,e=128,r=0,n=72,a=0;a<g;++a)128>(u=t[a])&&O.push(f(u));for(s=i=O.length,i&&O.push("-");s<g;){for(o=c,a=0;a<g;++a)(u=t[a])>=e&&u<o&&(o=u);for(o-e>m((c-r)/(y=s+1))&&d("overflow"),r+=(o-e)*y,e=o,a=0;a<g;++a)if((u=t[a])<e&&++r>c&&d("overflow"),u==e){for(h=r,p=36;!(h<(l=p<=n?1:p>=n+26?26:p-n));p+=36)j=h-l,v=36-l,O.push(f(x(l+j%v,0))),h=m(j/v);O.push(f(x(h,0))),n=w(r,y,s==i),r=0,++s}++r,++e}return O.join("")}o={version:"1.4.1",ucs2:{decode:b,encode:v},decode:j,encode:O,toASCII:function(t){return y(t,function(t){return p.test(t)?"xn--"+O(t):t})},toUnicode:function(t){return y(t,function(t){return h.test(t)?j(t.slice(4).toLowerCase()):t})}},void 0===(i=function(){return o}.call(e,r,e,t))||(t.exports=i)}()}).call(this,r(5)(t),r(14))},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,r){"use strict";e.decode=e.parse=r(17),e.encode=e.stringify=r(18)},function(t,e,r){"use strict";function s(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,r,n){e=e||"&",r=r||"=";var a={};if("string"!=typeof t||0===t.length)return a;var o=/\+/g;t=t.split(e);var c=1e3;n&&"number"==typeof n.maxKeys&&(c=n.maxKeys);var h=t.length;0<c&&h>c&&(h=c);for(var p=0;p<h;++p){var l,u,m,f,d=t[p].replace(o,"%20"),g=d.indexOf(r);0<=g?(l=d.substr(0,g),u=d.substr(g+1)):(l=d,u=""),m=decodeURIComponent(l),f=decodeURIComponent(u),s(a,m)?i(a[m])?a[m].push(f):a[m]=[a[m],f]:a[m]=f}return a};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,r){"use strict";var s=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return"";}};t.exports=function(t,e,r,o){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?n(a(t),function(a){var o=encodeURIComponent(s(a))+r;return i(t[a])?n(t[a],function(t){return o+encodeURIComponent(s(t))}).join(e):o+encodeURIComponent(s(t[a]))}).join(e):o?encodeURIComponent(s(o))+r+encodeURIComponent(s(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function n(t,e){if(t.map)return t.map(e);for(var r=[],s=0;s<t.length;s++)r.push(e(t[s],s));return r}var a=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},function(t,e,r){"use strict";var s=r(0),i=s.ValidatorResult,n=s.SchemaError,a={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,exclusiveMinimum:!0,exclusiveMaximum:!0,additionalItems:!0,$schema:!0,$ref:!0,extends:!0}},o=a.validators={};function c(t,e,r,s,i){var n=e.throwError;e.throwError=!1;var a=this.validateSchema(t,i,e,r);return e.throwError=n,!a.valid&&s instanceof Function&&s(a),a.valid}function h(t,e,r,s,i,n){if(this.types.object(t)&&(!e.properties||void 0===e.properties[i]))if(!1===e.additionalProperties)n.addError({name:"additionalProperties",argument:i,message:"additionalProperty "+JSON.stringify(i)+" exists in instance when not allowed"});else{var a=e.additionalProperties||{};"function"==typeof r.preValidateProperty&&r.preValidateProperty(t,i,a,r,s);var o=this.validateSchema(t[i],a,r,s.makeChild(a,i));o.instance!==n.instance[i]&&(n.instance[i]=o.instance),n.importErrors(o)}}o.type=function(t,e,r,s){if(void 0===t)return null;var n=new i(t,e,r,s),a=Array.isArray(e.type)?e.type:[e.type];if(!a.some(this.testType.bind(this,t,e,r,s))){var o=a.map(function(t){return t.id&&"<"+t.id+">"||t+""});n.addError({name:"type",argument:o,message:"is not of a type(s) "+o})}return n},o.anyOf=function(t,e,r,s){if(void 0===t)return null;var a=new i(t,e,r,s),o=new i(t,e,r,s);if(!Array.isArray(e.anyOf))throw new n("anyOf must be an array");if(!e.anyOf.some(c.bind(this,t,r,s,function(t){o.importErrors(t)}))){var h=e.anyOf.map(function(t,e){return t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+e+"]"});r.nestedErrors&&a.importErrors(o),a.addError({name:"anyOf",argument:h,message:"is not any of "+h.join(",")})}return a},o.allOf=function(t,e,r,s){if(void 0===t)return null;if(!Array.isArray(e.allOf))throw new n("allOf must be an array");var a=new i(t,e,r,s),o=this;return e.allOf.forEach(function(e,i){var n=o.validateSchema(t,e,r,s);if(!n.valid){var c=e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+i+"]";a.addError({name:"allOf",argument:{id:c,length:n.errors.length,valid:n},message:"does not match allOf schema "+c+" with "+n.errors.length+" error[s]:"}),a.importErrors(n)}}),a},o.oneOf=function(t,e,r,s){if(void 0===t)return null;if(!Array.isArray(e.oneOf))throw new n("oneOf must be an array");var a=new i(t,e,r,s),o=new i(t,e,r,s),h=e.oneOf.filter(c.bind(this,t,r,s,function(t){o.importErrors(t)})).length,p=e.oneOf.map(function(t,e){return t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+e+"]"});return 1!==h&&(r.nestedErrors&&a.importErrors(o),a.addError({name:"oneOf",argument:p,message:"is not exactly one from "+p.join(",")})),a},o.properties=function(t,e,r,s){if(this.types.object(t)){var n=new i(t,e,r,s),a=e.properties||{};for(var o in a){"function"==typeof r.preValidateProperty&&r.preValidateProperty(t,o,a[o],r,s);var c=Object.hasOwnProperty.call(t,o)?t[o]:void 0,h=this.validateSchema(c,a[o],r,s.makeChild(a[o],o));h.instance!==n.instance[o]&&(n.instance[o]=h.instance),n.importErrors(h)}return n}},o.patternProperties=function(t,e,r,s){if(this.types.object(t)){var n=new i(t,e,r,s),a=e.patternProperties||{};for(var o in t){var c=!0;for(var p in a){if(new RegExp(p).test(o)){c=!1,"function"==typeof r.preValidateProperty&&r.preValidateProperty(t,o,a[p],r,s);var l=this.validateSchema(t[o],a[p],r,s.makeChild(a[p],o));l.instance!==n.instance[o]&&(n.instance[o]=l.instance),n.importErrors(l)}}c&&h.call(this,t,e,r,s,o,n)}return n}},o.additionalProperties=function(t,e,r,s){if(this.types.object(t)){if(e.patternProperties)return null;var n=new i(t,e,r,s);for(var a in t)h.call(this,t,e,r,s,a,n);return n}},o.minProperties=function(t,e,r,s){if(this.types.object(t)){var n=new i(t,e,r,s);return Object.keys(t).length>=e.minProperties||n.addError({name:"minProperties",argument:e.minProperties,message:"does not meet minimum property length of "+e.minProperties}),n}},o.maxProperties=function(t,e,r,s){if(this.types.object(t)){var n=new i(t,e,r,s);return Object.keys(t).length<=e.maxProperties||n.addError({name:"maxProperties",argument:e.maxProperties,message:"does not meet maximum property length of "+e.maxProperties}),n}},o.items=function(t,e,r,s){var n=this;if(this.types.array(t)&&e.items){var a=new i(t,e,r,s);return t.every(function(t,i){var o=Array.isArray(e.items)?e.items[i]||e.additionalItems:e.items;if(void 0===o)return!0;if(!1===o)return a.addError({name:"items",message:"additionalItems not permitted"}),!1;var c=n.validateSchema(t,o,r,s.makeChild(o,i));return c.instance!==a.instance[i]&&(a.instance[i]=c.instance),a.importErrors(c),!0}),a}},o.minimum=function(t,e,r,s){if(this.types.number(t)){var n=new i(t,e,r,s);return(e.exclusiveMinimum&&!0===e.exclusiveMinimum?t>e.minimum:t>=e.minimum)||n.addError({name:"minimum",argument:e.minimum,message:"must have a minimum value of "+e.minimum}),n}},o.maximum=function(t,e,r,s){if(this.types.number(t)){var n=new i(t,e,r,s);return(e.exclusiveMaximum&&!0===e.exclusiveMaximum?t<e.maximum:t<=e.maximum)||n.addError({name:"maximum",argument:e.maximum,message:"must have a maximum value of "+e.maximum}),n}};var p=function(t,e,r,a,o,c){if(this.types.number(t)){var h=e[o];if(0==h)throw new n(o+" cannot be zero");var p=new i(t,e,r,a),l=s.getDecimalPlaces(t),u=s.getDecimalPlaces(h),m=Math.max(l,u),f=Math.pow(10,m);return 0!=Math.round(t*f)%Math.round(h*f)&&p.addError({name:o,argument:h,message:c+JSON.stringify(h)}),p}};function l(t,e,r){var i,n=r.length;for(i=e+1;i<n;i++)if(s.deepCompareStrict(t,r[i]))return!1;return!0}o.multipleOf=function(t,e,r,s){return p.call(this,t,e,r,s,"multipleOf","is not a multiple of (divisible by) ")},o.divisibleBy=function(t,e,r,s){return p.call(this,t,e,r,s,"divisibleBy","is not divisible by (multiple of) ")},o.required=function(t,e,r,s){var n=new i(t,e,r,s);return void 0===t&&!0===e.required?n.addError({name:"required",message:"is required"}):this.types.object(t)&&Array.isArray(e.required)&&e.required.forEach(function(e){void 0===t[e]&&n.addError({name:"required",argument:e,message:"requires property "+JSON.stringify(e)})}),n},o.pattern=function(t,e,r,s){if(this.types.string(t)){var n=new i(t,e,r,s);return t.match(e.pattern)||n.addError({name:"pattern",argument:e.pattern,message:"does not match pattern "+JSON.stringify(e.pattern.toString())}),n}},o.format=function(t,e,r,n){if(void 0!==t){var a=new i(t,e,r,n);return a.disableFormat||s.isFormat(t,e.format,this)||a.addError({name:"format",argument:e.format,message:"does not conform to the "+JSON.stringify(e.format)+" format"}),a}},o.minLength=function(t,e,r,s){if(this.types.string(t)){var n=new i(t,e,r,s),a=t.match(/[\uDC00-\uDFFF]/g);return t.length-(a?a.length:0)>=e.minLength||n.addError({name:"minLength",argument:e.minLength,message:"does not meet minimum length of "+e.minLength}),n}},o.maxLength=function(t,e,r,s){if(this.types.string(t)){var n=new i(t,e,r,s),a=t.match(/[\uDC00-\uDFFF]/g);return t.length-(a?a.length:0)<=e.maxLength||n.addError({name:"maxLength",argument:e.maxLength,message:"does not meet maximum length of "+e.maxLength}),n}},o.minItems=function(t,e,r,s){if(this.types.array(t)){var n=new i(t,e,r,s);return t.length>=e.minItems||n.addError({name:"minItems",argument:e.minItems,message:"does not meet minimum length of "+e.minItems}),n}},o.maxItems=function(t,e,r,s){if(this.types.array(t)){var n=new i(t,e,r,s);return t.length<=e.maxItems||n.addError({name:"maxItems",argument:e.maxItems,message:"does not meet maximum length of "+e.maxItems}),n}},o.uniqueItems=function(t,e,r,n){if(this.types.array(t)){var a=new i(t,e,r,n);return t.every(function(t,e,r){for(var i=e+1;i<r.length;i++)if(s.deepCompareStrict(t,r[i]))return!1;return!0})||a.addError({name:"uniqueItems",message:"contains duplicate item"}),a}},o.uniqueItems=function(t,e,r,s){if(this.types.array(t)){var n=new i(t,e,r,s);return t.every(l)||n.addError({name:"uniqueItems",message:"contains duplicate item"}),n}},o.dependencies=function(t,e,r,s){if(this.types.object(t)){var n=new i(t,e,r,s);for(var a in e.dependencies)if(void 0!==t[a]){var o=e.dependencies[a],c=s.makeChild(o,a);if("string"==typeof o&&(o=[o]),Array.isArray(o))o.forEach(function(e){void 0===t[e]&&n.addError({name:"dependencies",argument:c.propertyPath,message:"property "+e+" not found, required by "+c.propertyPath})});else{var h=this.validateSchema(t,o,r,c);n.instance!==h.instance&&(n.instance=h.instance),h&&h.errors.length&&(n.addError({name:"dependencies",argument:c.propertyPath,message:"does not meet dependency required by "+c.propertyPath}),n.importErrors(h))}}return n}},o.enum=function(t,e,r,a){if(void 0===t)return null;if(!Array.isArray(e.enum))throw new n("enum expects an array",e);var o=new i(t,e,r,a);return e.enum.some(s.deepCompareStrict.bind(null,t))||o.addError({name:"enum",argument:e.enum,message:"is not one of enum values: "+e.enum.map(String).join(",")}),o},o.const=function(t,e,r,n){if(void 0===t)return null;var a=new i(t,e,r,n);return s.deepCompareStrict(e.const,t)||a.addError({name:"const",argument:e.const,message:"does not exactly match expected constant: "+e.const}),a},o.not=o.disallow=function(t,e,r,s){var n=this;if(void 0===t)return null;var a=new i(t,e,r,s),o=e.not||e.disallow;return o?(Array.isArray(o)||(o=[o]),o.forEach(function(i){if(n.testType(t,e,r,s,i)){var o=i&&i.id&&"<"+i.id+">"||i;a.addError({name:"not",argument:o,message:"is of prohibited type "+o})}}),a):null},t.exports=a},function(t,e){e.procedureSchema={id:"procedureJSON",type:"object",title:"procedure json schema",properties:{id:{type:"string"},dataType:{type:"string"},stepDefinitionList:{type:"array",minItems:0,items:{$ref:"/stepDefinitionJSON"}},statementList:{type:"array",items:{type:"object"}},importList:{type:"array",items:{$ref:"/importJSON"}}},required:["dataType","stepDefinitionList"]},e.stepDefinitionSchema={id:"/stepDefinitionJSON",type:"object",title:"step definition json schema",properties:{id:{type:"string"},assets:{type:"array",items:{type:"object"}}},required:["id","assets"]},e.importSchema={id:"/importJSON",type:"object",title:"import json schema",properties:{url:{type:"string",pattern:"^/ExperienceService/(.*)?cms/projects/[^/]+/procedures/[^/]+$"}}}},function(t,e,r){(function(t,s){var i=function(){var t=function(t,e,r,s){for(r=r||{},s=t.length;s--;r[t[s]]=e);return r},e=[11,15,16,17,20,24,30,33,43,44,46,48],r=[11,16,17,20,24,30,33,43,44,46,48],s=[11,16,20,24,30,33,43,44,46,48],i=[11,16,24,30,33,43,44,46,48],n=[2,9],a=[1,13],o=[11,16,24,30,43,44,46,48],c=[2,21],h=[1,18],p=[1,25],l=[1,24],u=[11,16,24,43,44,46,48],m=[14,22,28,29,34,37],f=[2,33],d=[1,38],g=[1,39],y=[1,40],b=[1,41],v=[1,44],x=[11,39],w=[1,59],j=[1,56],O=[1,60],S=[1,58],E=[1,61],A=[1,55],L=[1,54],P=[1,68],k=[2,29],I=[11,16,24,39,43,44,46,48],R=[1,74],_=[1,72],T=[1,73],C=[1,75],U=[1,76],$=[1,77],N=[1,78],M=[1,79],D=[1,80],q=[1,81],F=[1,82],z=[1,83],V=[1,84],H=[14,25,28,29,34,37,39,54,55,56,57,58,59,60,61,62,63,64,65],Z=[2,40],J=[2,44],B=[1,95],W=[11,16,24,29,30,33,39,43,44,46,48],G=[14,28,29,34,37,39,54,55,58,59,60,61,62,63,64,65],X=[14,28,29,34,37,39,60,61,62,63,64,65],Y=[29,39],K={trace:function(){},yy:{},symbols_:{error:2,process_definition:3,version_declaration:4,namespace_declaration:5,extend_declaration:6,import_list:7,step_definition_list:8,properties_definition:9,statement_list:10,EOF:11,VERSION:12,NUMBER:13,";":14,NAMESPACE:15,NAME:16,EXTEND:17,STRING:18,import:19,IMPORT:20,import_identifiers:21,FROM:22,uuid_or_name:23,UUID:24,"*":25,"(":26,id_list:27,")":28,",":29,PROPERTIES:30,object_definition:31,step_definition:32,STEP:33,":":34,object_definition_start:35,object_definition_finish:36,"{":37,nvp_list:38,"}":39,nvp:40,expression:41,statement:42,WHILE:43,CONDITIONAL:44,condition_list:45,SET:46,"=":47,CALL:48,parameter_list:49,condition:50,parameter:51,literal:52,BOOLEAN:53,"+":54,"-":55,"/":56,"%":57,"||":58,"&&":59,"<":60,"<=":61,"==":62,"!=":63,">=":64,">":65,"!":66,$accept:0,$end:1},terminals_:{2:"error",11:"EOF",12:"VERSION",13:"NUMBER",14:";",15:"NAMESPACE",16:"NAME",17:"EXTEND",18:"STRING",20:"IMPORT",22:"FROM",24:"UUID",25:"*",26:"(",28:")",29:",",30:"PROPERTIES",33:"STEP",34:":",37:"{",39:"}",43:"WHILE",44:"CONDITIONAL",46:"SET",47:"=",48:"CALL",53:"BOOLEAN",54:"+",55:"-",56:"/",57:"%",58:"||",59:"&&",60:"<",61:"<=",62:"==",63:"!=",64:">=",65:">",66:"!"},productions_:[0,[3,8],[4,3],[4,0],[5,3],[5,0],[6,3],[6,0],[7,3],[7,0],[19,4],[23,1],[23,1],[21,1],[21,1],[21,3],[27,1],[27,3],[9,2],[9,0],[8,2],[8,0],[32,5],[32,3],[31,2],[35,1],[36,2],[38,3],[38,1],[38,0],[40,3],[40,3],[10,2],[10,0],[42,2],[42,5],[42,4],[42,5],[42,4],[45,2],[45,0],[50,5],[49,3],[49,1],[49,0],[51,3],[52,1],[52,1],[52,1],[41,3],[41,3],[41,3],[41,3],[41,3],[41,3],[41,3],[41,3],[41,3],[41,3],[41,3],[41,3],[41,3],[41,2],[41,2],[41,3],[41,1],[41,1],[41,3]],performAction:function(t,e,r,s,i,n,a){var o=n.length-1;switch(i){case 1:return this.$=["process",n[o-7],n[o-6],n[o-5],n[o-4],n[o-3],n[o-2],n[o-1]],this.$;case 2:this.$=["version",n[o-1]];break;case 3:this.$=["version"];break;case 4:this.$=["namespace",n[o-1]];break;case 5:this.$=["namespace"];break;case 6:this.$=["extend",et(n[o-1])];break;case 7:this.$=["extend"];break;case 8:case 17:case 42:this.$=tt(n[o],n[o-2]);break;case 9:this.$=["import_list"];break;case 10:this.$=[n[o-2],et(n[o])];break;case 11:case 12:case 13:case 14:case 24:this.$=n[o];break;case 15:case 36:this.$=n[o-1];break;case 16:this.$=[n[o]];break;case 18:this.$=["properties",n[o]];break;case 19:this.$=["properties"];break;case 20:case 32:case 39:this.$=tt(n[o],n[o-1]);break;case 21:this.$=["step_definition_list"];break;case 22:this.$=[n[o-3],n[o-1],n[o]];break;case 23:this.$=[n[o-1],n[o]];break;case 25:Q.push({});break;case 26:this.$=Q.pop();break;case 30:case 31:Q[Q.length-1][n[o-2]]=n[o];break;case 33:this.$=["statement_list"];break;case 34:this.$=["step",n[o-1]];break;case 35:this.$=["while",n[o-3],n[o-1]];break;case 37:this.$=["set",n[o-3],n[o-1]];break;case 38:this.$=["call",et(n[o-2]),n[o-1]];break;case 40:this.$=["condition_list"];break;case 41:this.$=[n[o-4],n[o-1]];break;case 43:this.$=["parameter_list",n[o]];break;case 44:this.$=["parameter_list"];break;case 45:this.$=[n[o-2],n[o]];break;case 46:this.$=+t;break;case 47:this.$=t.substr(1,t.length-2);break;case 48:this.$="true"===t;break;case 49:this.$=["add",n[o-2],n[o]];break;case 50:this.$=["sub",n[o-2],n[o]];break;case 51:this.$=["mul",n[o-2],n[o]];break;case 52:this.$=["div",n[o-2],n[o]];break;case 53:this.$=["mod",n[o-2],n[o]];break;case 54:this.$=["or",n[o-2],n[o]];break;case 55:this.$=["and",n[o-2],n[o]];break;case 56:this.$=["lt",n[o-2],n[o]];break;case 57:this.$=["le",n[o-2],n[o]];break;case 58:this.$=["eq",n[o-2],n[o]];break;case 59:this.$=["ne",n[o-2],n[o]];break;case 60:this.$=["ge",n[o-2],n[o]];break;case 61:this.$=["gt",n[o-2],n[o]];break;case 62:this.$=["not",n[o]];break;case 63:this.$=["neg",n[o]];break;case 64:this.$=["set",n[o-2],n[o]];break;case 65:this.$=n[o];break;case 66:this.$=["get",n[o]];break;case 67:this.$=n[o-1];}},table:[t(e,[2,3],{3:1,4:2,12:[1,3]}),{1:[3]},t(r,[2,5],{5:4,15:[1,5]}),{13:[1,6]},t(s,[2,7],{6:7,17:[1,8]}),{16:[1,9]},{14:[1,10]},t(i,n,{7:11,19:12,20:a}),{18:[1,14]},{14:[1,15]},t(e,[2,2]),t(o,c,{8:16,32:17,33:h}),{14:[1,19]},{16:p,21:20,23:21,24:l,25:[1,22],26:[1,23]},{14:[1,26]},t(r,[2,4]),t(u,[2,19],{9:27,30:[1,28]}),t(o,c,{32:17,8:29,33:h}),{16:p,23:30,24:l},t(i,n,{19:12,7:31,20:a}),{22:[1,32]},{22:[2,13]},{22:[2,14]},{16:p,23:34,24:l,27:33},t(m,[2,11]),t(m,[2,12]),t(s,[2,6]),{10:35,11:f,16:p,23:37,24:l,42:36,43:d,44:g,46:y,48:b},{31:42,35:43,37:v},t(o,[2,20]),{31:46,34:[1,45],35:43,37:v},t(i,[2,8]),{18:[1,47]},{28:[1,48]},{28:[2,16],29:[1,49]},{11:[1,50]},t(x,f,{42:36,23:37,10:51,16:p,24:l,43:d,44:g,46:y,48:b}),{14:[1,52]},{13:w,16:j,18:O,26:S,41:53,52:57,53:E,55:A,66:L},{37:[1,62]},{16:[1,63]},{18:[1,64]},t(u,[2,18]),{16:P,36:65,38:66,39:k,40:67},t([16,39],[2,25]),{16:p,23:69,24:l},t(i,[2,23]),{14:[2,10]},{22:[2,15]},{16:p,23:34,24:l,27:70},{1:[2,1]},t(x,[2,32]),t(I,[2,34]),{25:R,37:[1,71],54:_,55:T,56:C,57:U,58:$,59:N,60:M,61:D,62:q,63:F,64:z,65:V},{13:w,16:j,18:O,26:S,41:85,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:86,52:57,53:E,55:A,66:L},t(H,[2,66],{47:[1,87]}),t(H,[2,65]),{13:w,16:j,18:O,26:S,41:88,52:57,53:E,55:A,66:L},t(H,[2,46]),t(H,[2,47]),t(H,[2,48]),{13:w,16:j,18:O,26:S,39:Z,41:91,45:89,50:90,52:57,53:E,55:A,66:L},{47:[1,92]},{14:J,16:B,49:93,51:94},t(W,[2,24]),{39:[1,96]},{29:[1,97],39:[2,28]},{34:[1,98]},{31:99,35:43,37:v},{28:[2,17]},{10:100,16:p,23:37,24:l,39:f,42:36,43:d,44:g,46:y,48:b},{13:w,16:j,18:O,26:S,41:101,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:102,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:103,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:104,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:105,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:106,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:107,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:108,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:109,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:110,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:111,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:112,52:57,53:E,55:A,66:L},{13:w,16:j,18:O,26:S,41:113,52:57,53:E,55:A,66:L},t(H,[2,62]),t(H,[2,63]),{13:w,16:j,18:O,26:S,41:114,52:57,53:E,55:A,66:L},{25:R,28:[1,115],54:_,55:T,56:C,57:U,58:$,59:N,60:M,61:D,62:q,63:F,64:z,65:V},{39:[1,116]},{13:w,16:j,18:O,26:S,39:Z,41:91,45:117,50:90,52:57,53:E,55:A,66:L},{25:R,34:[1,118],54:_,55:T,56:C,57:U,58:$,59:N,60:M,61:D,62:q,63:F,64:z,65:V},{13:w,16:j,18:O,26:S,41:119,52:57,53:E,55:A,66:L},{14:[1,120]},{14:[2,43],29:[1,121]},{47:[1,122]},t(W,[2,26]),{16:P,38:123,39:k,40:67},{13:w,16:j,18:O,26:S,31:125,35:43,37:v,41:124,52:57,53:E,55:A,66:L},t(i,[2,22]),{39:[1,126]},t(G,[2,49],{25:R,56:C,57:U}),t(G,[2,50],{25:R,56:C,57:U}),t(H,[2,51]),t(H,[2,52]),t(H,[2,53]),t([14,28,29,34,37,39,58,60,61,62,63,64,65],[2,54],{25:R,54:_,55:T,56:C,57:U,59:N}),t([14,28,29,34,37,39,58,59,60,61,62,63,64,65],[2,55],{25:R,54:_,55:T,56:C,57:U}),t(X,[2,56],{25:R,54:_,55:T,56:C,57:U,58:$,59:N}),t(X,[2,57],{25:R,54:_,55:T,56:C,57:U,58:$,59:N}),t(X,[2,58],{25:R,54:_,55:T,56:C,57:U,58:$,59:N}),t(X,[2,59],{25:R,54:_,55:T,56:C,57:U,58:$,59:N}),t(X,[2,60],{25:R,54:_,55:T,56:C,57:U,58:$,59:N}),t(X,[2,61],{25:R,54:_,55:T,56:C,57:U,58:$,59:N}),t(H,[2,64]),t(H,[2,67]),t(I,[2,36]),{39:[2,39]},{37:[1,127]},{14:[1,128],25:R,54:_,55:T,56:C,57:U,58:$,59:N,60:M,61:D,62:q,63:F,64:z,65:V},t(I,[2,38]),{14:J,16:B,49:129,51:94},{13:w,16:j,18:O,26:S,41:130,52:57,53:E,55:A,66:L},{39:[2,27]},t(Y,[2,30],{25:R,54:_,55:T,56:C,57:U,58:$,59:N,60:M,61:D,62:q,63:F,64:z,65:V}),t(Y,[2,31]),t(I,[2,35]),{10:131,16:p,23:37,24:l,39:f,42:36,43:d,44:g,46:y,48:b},t(I,[2,37]),{14:[2,42]},t([14,29],[2,45],{25:R,54:_,55:T,56:C,57:U,58:$,59:N,60:M,61:D,62:q,63:F,64:z,65:V}),{39:[1,132]},t([13,16,18,26,39,53,55,66],[2,41])],defaultActions:{21:[2,13],22:[2,14],47:[2,10],48:[2,15],50:[2,1],70:[2,17],117:[2,39],123:[2,27],129:[2,42]},parseError:function(t,e){if(!e.recoverable){var r=new Error(t);throw r.hash=e,r}this.trace(t)},parse:function(t){var e=this,r=[0],s=[null],i=[],n=this.table,a="",o=0,c=0,h=0,p=2,l=1,u=i.slice.call(arguments,1),m=Object.create(this.lexer),f={yy:{}};for(var d in this.yy)Object.prototype.hasOwnProperty.call(this.yy,d)&&(f.yy[d]=this.yy[d]);m.setInput(t,f.yy),f.yy.lexer=m,f.yy.parser=this,void 0===m.yylloc&&(m.yylloc={});var g=m.yylloc;i.push(g);var y=m.options&&m.options.ranges;"function"==typeof f.yy.parseError?this.parseError=f.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var b,v,x,w,j,O,S,E,A,L=function(){var t;return"number"!=typeof(t=m.lex()||l)&&(t=e.symbols_[t]||t),t},P={};;){if(x=r[r.length-1],this.defaultActions[x]?w=this.defaultActions[x]:(null==b&&(b=L()),w=n[x]&&n[x][b]),void 0===w||!w.length||!w[0]){var k="";for(O in A=[],n[x])this.terminals_[O]&&O>p&&A.push("'"+this.terminals_[O]+"'");k=m.showPosition?"Parse error on line "+(o+1)+":\n"+m.showPosition()+"\nExpecting "+A.join(", ")+", got '"+(this.terminals_[b]||b)+"'":"Parse error on line "+(o+1)+": Unexpected "+(b==l?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(k,{text:m.match,token:this.terminals_[b]||b,line:m.yylineno,loc:g,expected:A})}if(w[0]instanceof Array&&1<w.length)throw new Error("Parse Error: multiple actions possible at state: "+x+", token: "+b);switch(w[0]){case 1:r.push(b),s.push(m.yytext),i.push(m.yylloc),r.push(w[1]),b=null,v?(b=v,v=null):(c=m.yyleng,a=m.yytext,o=m.yylineno,g=m.yylloc,0<h&&h--);break;case 2:if(S=this.productions_[w[1]][1],P.$=s[s.length-S],P._$={first_line:i[i.length-(S||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(S||1)].first_column,last_column:i[i.length-1].last_column},y&&(P._$.range=[i[i.length-(S||1)].range[0],i[i.length-1].range[1]]),void 0!==(j=this.performAction.apply(P,[a,c,o,f.yy,w[1],s,i].concat(u))))return j;S&&(r=r.slice(0,2*(-1*S)),s=s.slice(0,-1*S),i=i.slice(0,-1*S)),r.push(this.productions_[w[1]][0]),s.push(P.$),i.push(P._$),E=n[r[r.length-2]][r[r.length-1]],r.push(E);break;case 3:return!0;}}return!0}},Q=[];function tt(t,e){return t.splice(1,0,e),t}function et(t){return 1<t.length&&(t.match(/^"[^"]*"$/)||t.match(/^'[^']*'$/))?t.substr(1,t.length-2):t}var rt={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var s=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===s.length?this.yylloc.first_column:0)+s[s.length-r.length].length-r[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return 20>t.length&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var r,s,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(s=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],r=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var n in i)this[n]=i[n];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,r,s;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),n=0;n<i.length;n++)if((r=this._input.match(this.rules[i[n]]))&&(!e||r[0].length>e[0].length)){if(e=r,s=n,this.options.backtrack_lexer){if(!1!==(t=this.test_match(r,i[n])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,i[s]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return 0<=(t=this.conditionStack.length-1-Math.abs(t||0))?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,r,s){switch(r){case 0:case 1:break;case 2:return 48;case 3:return 44;case 4:return 17;case 5:return 22;case 6:return 20;case 7:return 15;case 8:return 30;case 9:return 46;case 10:return 33;case 11:return 12;case 12:return 43;case 13:return 53;case 14:return 13;case 15:return 16;case 16:return 24;case 17:return 18;case 18:return 54;case 19:return 55;case 20:return 25;case 21:return 56;case 22:return 57;case 23:return 58;case 24:return 59;case 25:return 66;case 26:return 60;case 27:return 61;case 28:return 62;case 29:return 63;case 30:return 65;case 31:return 64;case 32:return 47;case 33:return 26;case 34:return 28;case 35:return 37;case 36:return 39;case 37:return 34;case 38:return 14;case 39:return 29;case 40:return 11;}},rules:[/^(?:\/\/.*)/,/^(?:\s+)/,/^(?:call\b)/,/^(?:conditional\b)/,/^(?:extend\b)/,/^(?:from\b)/,/^(?:import\b)/,/^(?:namespace\b)/,/^(?:properties\b)/,/^(?:set\b)/,/^(?:step\b)/,/^(?:version\b)/,/^(?:while\b)/,/^(?:true|false\b)/,/^(?:-?[0-9]+(\.[0-9]+)?)/,/^(?:[a-zA-Z_$][a-zA-Z0-9_$]*(\.[a-zA-Z_$][a-zA-Z0-9_$]*)*)/,/^(?:\{[a-zA-Z0-9]+(-[a-zA-Z0-9]+)*\})/,/^(?:"[^"]*"|'[^']*')/,/^(?:\+)/,/^(?:-)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\|\|)/,/^(?:&&)/,/^(?:!)/,/^(?:<)/,/^(?:<=)/,/^(?:==)/,/^(?:!=)/,/^(?:>)/,/^(?:>=)/,/^(?:=)/,/^(?:\()/,/^(?:\))/,/^(?:\{)/,/^(?:\})/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],inclusive:!0}}};function st(){this.yy={}}return K.lexer=rt,st.prototype=K,K.Parser=st,new st}();e.parser=i,e.Parser=i.Parser,e.parse=function(){return i.parse.apply(i,arguments)},e.main=function(e){e[1]||(console.log("Usage: "+e[0]+" FILE"),t.exit(1))},r.c[r.s]===s&&e.main(t.argv.slice(1))}).call(this,r(22),r(5)(t))},function(t,e){var r,s,i=t.exports={};function n(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(t){if(r===setTimeout)return setTimeout(t,0);if((r===n||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:n}catch(t){r=n}try{s="function"==typeof clearTimeout?clearTimeout:a}catch(t){s=a}}();var c,h=[],p=!1,l=-1;function u(){p&&c&&(p=!1,c.length?h=c.concat(h):l=-1,h.length&&m())}function m(){if(!p){var t=o(u);p=!0;for(var e=h.length;e;){for(c=h,h=[];++l<e;)c&&c[l].run();l=-1,e=h.length}c=null,p=!1,function(t){if(s===clearTimeout)return clearTimeout(t);if((s===a||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(t);try{s(t)}catch(e){try{return s.call(null,t)}catch(e){return s.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function d(){}i.nextTick=function(t){var e=Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];h.push(new f(t,e)),1!==h.length||p||o(m)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=d,i.addListener=d,i.once=d,i.off=d,i.removeListener=d,i.removeAllListeners=d,i.emit=d,i.prependListener=d,i.prependOnceListener=d,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,r){"use strict";const s=r(3).v1;e.CMSConnection=class{constructor(t,e){this.baseURL=t.url,this.password=t.password,this.username=t.username,this.requestConfig=t.requestConfig,this._fetch=e,this.orgId=t.orgId,this.pathPrefix=t.pathPrefix||"/ExperienceService",this.pathPrefix.startsWith("/")||(this.pathPrefix="/"+this.pathPrefix)}calculateOptions(t){let e=Object.assign({rejectUnauthorized:!1},t,this.requestConfig);return e.headers=Object.assign({"X-Requested-With":"XmlHttpRequest","x-correlation-id":s(),"x-no-form-based-login":"true"},t.headers||{}),this.username&&this.password&&(e.auth=this.username+":"+this.password),e}getCmsBaseUrl(){return this.pathPrefix+"/"+(this.orgId?this.orgId+"/":"")+"cms/"}delete(t){return this.fetch(t,{method:"DELETE"})}get(t,e,r){let s=Object.assign({},{method:"GET"},r);e&&(s.headers=Object.assign({},s.headers,{Accept:e}));const i=/application\/json/.test(e);return this.fetch(t,s,i)}head(t){return this.fetch(t,{method:"HEAD"})}lookup(t){let e="/id-resolution/resolutions/?key="+encodeURIComponent(t);return this.fetch(e,{method:"GET",headers:{Accept:"application/json"}},!0).then(e=>{let r=e.resolutions;if(0<r.length)return r[0].value;throw new Error("404: No such resource: "+t)})}post(t,e,r){let s={method:"POST",headers:{"Content-Type":e},body:r};return this.fetch(t,s,!0)}put(t,e,r,s){return this._updateRequest(t,e,r,s)}patch(t,e,r,s){return this._updateRequest(t,e,r,s,"PATCH")}_updateRequest(t,e,r,s={},i="PUT"){let n={method:i,headers:{"Content-Type":e},body:r};return this.fetch(t,n,!0,s.fetch)}fetch(t,e,r,s){return new Promise((i,n)=>{const a=this.calculateOptions(e);(s||this._fetch)(this.baseURL+t,a).then(t=>{t&&t.ok?204===t.status?i():i(r?t.json():t.text()):n(t||new Error("fetch failed, no response"))},n)})}}}])});